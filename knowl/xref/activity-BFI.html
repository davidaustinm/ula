<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: default-modern                 *-->
<!--*  Palette: blue-green                   *-->
<!--******************************************-->

<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<article class="activity project-like"><h4 class="heading">
<span class="type">Activity</span><span class="space heading-divison-mark heading-divison-mark__space"> </span><span class="codenumber">6.5.4</span><span class="period heading-divison-mark heading-divison-mark__period">.</span>
</h4>
<div class="para logical">
<ol class="lower-alpha ol-marker-1" id="activity-BFI-1-1-1">
<li>
<div class="para logical">
<div class="para">Suppose we are interested in finding the least-squares approximate solution to the equation <span class="process-math">\(A\xvec =
\bvec\)</span> and that we have the <span class="process-math">\(QR\)</span> factorization <span class="process-math">\(A=QR\text{.}\)</span>  Explain why the least-squares approximate solution is given by solving</div>
<div class="displaymath process-math">
\begin{align*}
A\xhat \amp = QQ^T\bvec \\\\
QR\xhat \amp = QQ^T\bvec \\
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item a"><a href="#activity-BFI-1-1-1-1" title="Copy heading and permalink for Item a" aria-label="Copy heading and permalink for Item a">ðŸ”—</a></div>
</li>
<li>
<div class="para logical">
<div class="para">Multiply both sides of the second expression by <span class="process-math">\(Q^T\)</span> and explain why</div>
<div class="displaymath process-math">
\begin{equation*}
R\xhat = Q^T\bvec.
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical">
<div class="para">Since <span class="process-math">\(R\)</span> is upper triangular, this is a relatively simple equation to solve using back substitution, as we saw in <a href="sec-gaussian-revisited.html" class="internal" title="Section 5.1: Gaussian elimination revisited">SectionÂ 5.1</a>.  We will therefore write the least-squares approximate solution as</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/sec-gaussian-revisited.html">
\begin{equation*}
\xhat = R^{-1}Q^T\bvec,
\end{equation*}
</div>
<div class="para">and put this to use in the following context.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item b"><a href="#activity-BFI-1-1-1-2" title="Copy heading and permalink for Item b" aria-label="Copy heading and permalink for Item b">ðŸ”—</a></div>
</li>
<li>
<div class="para logical">
<div class="para">Brozakâ€™s formula, which is used to calculate a personâ€™s body fat index <span class="process-math">\(BFI\text{,}\)</span> is</div>
<div class="displaymath process-math">
\begin{equation*}
BFI = 100 \left(\frac{4.57}{\rho} - 4.142\right)
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(\rho\)</span> denotes a personâ€™s body density in grams per cubic centimeter.  Obtaining an accurate measure of <span class="process-math">\(\rho\)</span> is difficult, however, because it requires submerging the person in water and measuring the volume of water displaced.  Instead, we will gather several other body measurements, which are more easily obtained, and use it to predict <span class="process-math">\(BFI\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical">
<div class="para">For instance, suppose we take 10 patients and measure their weight <span class="process-math">\(w\)</span> in pounds, height <span class="process-math">\(h\)</span> in inches, abdomen <span class="process-math">\(a\)</span> in centimeters, wrist circumference <span class="process-math">\(r\)</span> in centimeters, neck circumference <span class="process-math">\(n\)</span> in centimeters, and <span class="process-math">\(BFI\text{.}\)</span>  Evaluating the following cell loads and displays the data. <div id="activity-BFI-1-1-1-3-2-7" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/bfi.csv')
weight = vector(df['Weight'])
height = vector(df['Height'])
abdomen = vector(df['Abdomen'])
wrist = vector(df['Wrist'])
neck = vector(df['Neck'])
BFI = vector(df['BFI'])
print(df)
</script></div> In addition, that cell provides:</div>
<ol class="lower-alpha lower-alpha-level-1" id="activity-BFI-1-1-1-3-2-8">
<li>
<div class="para">vectors <code class="code-inline tex2jax_ignore">weight</code>, <code class="code-inline tex2jax_ignore">height</code>, <code class="code-inline tex2jax_ignore">abdomen</code>, <code class="code-inline tex2jax_ignore">wrist</code>, <code class="code-inline tex2jax_ignore">neck</code>, and <code class="code-inline tex2jax_ignore">BFI</code> formed from the columns of the dataset.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item c.a"><a href="#activity-BFI-1-1-1-3-2-8-1" title="Copy heading and permalink for Item c.a" aria-label="Copy heading and permalink for Item c.a">ðŸ”—</a></div>
</li>
<li>
<div class="para">the command <code class="code-inline tex2jax_ignore">onesvec(n)</code>, which returns an <span class="process-math">\(n\)</span>-dimensional vector whose entries are all one.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item c.b"><a href="#activity-BFI-1-1-1-3-2-8-2" title="Copy heading and permalink for Item c.b" aria-label="Copy heading and permalink for Item c.b">ðŸ”—</a></div>
</li>
<li>
<div class="para">the command <code class="code-inline tex2jax_ignore">QR(A)</code> that returns the <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\)</span> as <code class="code-inline tex2jax_ignore">Q, R = QR(A)</code>.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item c.c"><a href="#activity-BFI-1-1-1-3-2-8-3" title="Copy heading and permalink for Item c.c" aria-label="Copy heading and permalink for Item c.c">ðŸ”—</a></div>
</li>
<li>
<div class="para">the command <code class="code-inline tex2jax_ignore">demean(v)</code>, which returns the demeaned vector <span class="process-math">\(\widetilde{\vvec}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item c.d"><a href="#activity-BFI-1-1-1-3-2-8-4" title="Copy heading and permalink for Item c.d" aria-label="Copy heading and permalink for Item c.d">ðŸ”—</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical">
<div class="para">We would like to find the linear function</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1w + \beta_2h + \beta_3a + \beta_4r +
\beta_5n = BFI
\end{equation*}
</div>
<div class="para">that best fits the data.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para">Use the first data point to write an equation for the parameters <span class="process-math">\(\beta_0,\beta_1,\ldots,\beta_5\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item c"><a href="#activity-BFI-1-1-1-3" title="Copy heading and permalink for Item c" aria-label="Copy heading and permalink for Item c">ðŸ”—</a></div>
</li>
<li>
<div class="para">Describe the linear system <span class="process-math">\(A\xvec = \bvec\)</span> for these parameters.  More specifically, describe how the matrix <span class="process-math">\(A\)</span> and the vector <span class="process-math">\(\bvec\)</span> are formed.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item d"><a href="#activity-BFI-1-1-1-4" title="Copy heading and permalink for Item d" aria-label="Copy heading and permalink for Item d">ðŸ”—</a></div>
</li>
<li>
<div class="para">Construct the matrix <span class="process-math">\(A\)</span> and find its <span class="process-math">\(QR\)</span> factorization in the cell below. <div id="activity-BFI-1-1-1-5-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item e"><a href="#activity-BFI-1-1-1-5" title="Copy heading and permalink for Item e" aria-label="Copy heading and permalink for Item e">ðŸ”—</a></div>
</li>
<li>
<div class="para">Find the least-squares approximate solution <span class="process-math">\(\xhat\)</span> by solving the equation <span class="process-math">\(R\xhat =
Q^T\bvec\text{.}\)</span>  You may want to use <code class="code-inline tex2jax_ignore">N(xhat)</code> to display a decimal approximation of the vector. What are the parameters <span class="process-math">\(\beta_0,\beta_1,\ldots,\beta_5\)</span> that best fit the data?<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-6-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item f"><a href="#activity-BFI-1-1-1-6" title="Copy heading and permalink for Item f" aria-label="Copy heading and permalink for Item f">ðŸ”—</a></div>
</li>
<li>
<div class="para">Find the coefficient of determination <span class="process-math">\(R^2\)</span> for your parameters.  What does this imply about the quality of the fit? <div id="activity-BFI-1-1-1-7-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-7-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item g"><a href="#activity-BFI-1-1-1-7" title="Copy heading and permalink for Item g" aria-label="Copy heading and permalink for Item g">ðŸ”—</a></div>
</li>
<li>
<div class="para">Suppose a personâ€™s measurements are: weight 190, height 70, abdomen 90, wrist 18, and neck 35.  Estimate this personâ€™s <span class="process-math">\(BFI\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-8-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item h"><a href="#activity-BFI-1-1-1-8" title="Copy heading and permalink for Item h" aria-label="Copy heading and permalink for Item h">ðŸ”—</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Activity 6.5.4"><a href="#activity-BFI" title="Copy heading and permalink for Activity 6.5.4" aria-label="Copy heading and permalink for Activity 6.5.4">ðŸ”—</a></div></article><span class="incontext"><a class="internal" href="sec-least-squares.html#activity-BFI">in-context</a></span>
</body>
</html>
