<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Fourier transforms and Sage</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
    evalButtonText: 'Activate',
    });
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute', linked:true,
    evalButtonText: 'Evaluate'});
    </script>
  </head>
  <body>
    <h1>Fourier transforms and Sage</h1>

    <p>
      The first Sage cell on this page loads some data that will be
      helpful in this activity.  You should evaluate this cell and
      then use the other cells for your work.
    </p>

    <div class="mycell">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">
mat = [[cos((2*i+1)*j*pi/16) for j in range(8)] for i in range(8)]
P = matrix(mat).numerical_approx()
luminance = matrix([
                    [176, 170, 170, 169, 162, 160, 155, 150],
                    [181, 179, 175, 167, 162, 160, 154, 149],
                    [165, 170, 169, 161, 162, 161, 160, 158],
                    [139, 150, 164, 166, 159, 160, 162, 163],
                    [131, 137, 157, 165, 163, 163, 164, 164],
                    [131, 132, 153, 161, 167, 167, 167, 169],
                    [140, 142, 157, 166, 166, 166, 167, 169],
                    [150, 152, 160, 168, 172, 170, 168, 168]])
x = luminance.column(0)

def double_fourier(A):
    return N( (P.inverse()* (P.inverse()*A).T).T, digits=3)
def round_matrix(A, scale):
    entries = []
    for r in range(8):
        for c in range(8):
            e = round(A[r][c])
            if abs(e) < scale:
                 e = 0
            entries.append(e)
    return matrix(8, 8, entries)
			
def inverse_double_fourier(A):
    return N( P * (P*A.T).T, digits=3)
print("Finished!")
      </script>
    </div> 

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

    <div class="compute">
      <script type="text/x-sage">

      </script>
    </div>

  </body>
</html>
