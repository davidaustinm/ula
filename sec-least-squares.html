<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: default-modern                 *-->
<!--*  Palette: blue-green                   *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Orthogonal least squares</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Understanding Linear Algebra">
<meta property="book:author" content=" David Austin ">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.9.3';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.47a5fea5694fc0ae.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.014cb392a13bd045.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.8141ae22fd347e48.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script async="" src="https://cse.google.com/cse.js?cx=015103900096539427448:ngwuia10qci"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body id="ula" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href="https://understandinglinearalgebra.org"><img src="external/images/ula-logo.png" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="ula.html"><span class="title">Understanding Linear Algebra</span></a></h1>
<p class="byline">David Austin</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><a class="index-button button" href="backmatter-3.html" title="Index"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe88e;</span><span class="name">Index</span></a><div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
<div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-gram-schmidt.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="chap6.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="chap7.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\avec}{{\mathbf a}}
\newcommand{\bvec}{{\mathbf b}}
\newcommand{\cvec}{{\mathbf c}}
\newcommand{\dvec}{{\mathbf d}}
\newcommand{\dtil}{\widetilde{\mathbf d}}
\newcommand{\evec}{{\mathbf e}}
\newcommand{\fvec}{{\mathbf f}}
\newcommand{\nvec}{{\mathbf n}}
\newcommand{\pvec}{{\mathbf p}}
\newcommand{\qvec}{{\mathbf q}}
\newcommand{\svec}{{\mathbf s}}
\newcommand{\tvec}{{\mathbf t}}
\newcommand{\uvec}{{\mathbf u}}
\newcommand{\vvec}{{\mathbf v}}
\newcommand{\wvec}{{\mathbf w}}
\newcommand{\xvec}{{\mathbf x}}
\newcommand{\yvec}{{\mathbf y}}
\newcommand{\zvec}{{\mathbf z}}
\newcommand{\rvec}{{\mathbf r}}
\newcommand{\mvec}{{\mathbf m}}
\newcommand{\zerovec}{{\mathbf 0}}
\newcommand{\onevec}{{\mathbf 1}}
\newcommand{\real}{{\mathbb R}}
\newcommand{\twovec}[2]{\left[\begin{array}{r}#1 \\ #2
\end{array}\right]}
\newcommand{\ctwovec}[2]{\left[\begin{array}{c}#1 \\ #2
\end{array}\right]}
\newcommand{\threevec}[3]{\left[\begin{array}{r}#1 \\ #2 \\ #3
\end{array}\right]}
\newcommand{\cthreevec}[3]{\left[\begin{array}{c}#1 \\ #2 \\ #3
\end{array}\right]}
\newcommand{\fourvec}[4]{\left[\begin{array}{r}#1 \\ #2 \\ #3 \\ #4
\end{array}\right]}
\newcommand{\cfourvec}[4]{\left[\begin{array}{c}#1 \\ #2 \\ #3 \\ #4
\end{array}\right]}
\newcommand{\fivevec}[5]{\left[\begin{array}{r}#1 \\ #2 \\ #3 \\
#4 \\ #5 \\ \end{array}\right]}
\newcommand{\cfivevec}[5]{\left[\begin{array}{c}#1 \\ #2 \\ #3 \\
#4 \\ #5 \\ \end{array}\right]}
\newcommand{\mattwo}[4]{\left[\begin{array}{rr}#1 \amp #2 \\ #3 \amp #4 \\ \end{array}\right]}
\newcommand{\laspan}[1]{\text{Span}\{#1\}}
\newcommand{\bcal}{{\cal B}}
\newcommand{\ccal}{{\cal C}}
\newcommand{\scal}{{\cal S}}
\newcommand{\wcal}{{\cal W}}
\newcommand{\ecal}{{\cal E}}
\newcommand{\coords}[2]{\left\{#1\right\}_{#2}}
\newcommand{\gray}[1]{\color{gray}{#1}}
\newcommand{\lgray}[1]{\color{lightgray}{#1}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\row}{\text{Row}}
\newcommand{\col}{\text{Col}}
\renewcommand{\row}{\text{Row}}
\newcommand{\nul}{\text{Nul}}
\newcommand{\var}{\text{Var}}
\newcommand{\corr}{\text{corr}}
\newcommand{\len}[1]{\left|#1\right|}
\newcommand{\bbar}{\overline{\bvec}}
\newcommand{\bhat}{\widehat{\bvec}}
\newcommand{\bperp}{\bvec^\perp}
\newcommand{\xhat}{\widehat{\xvec}}
\newcommand{\vhat}{\widehat{\vvec}}
\newcommand{\uhat}{\widehat{\uvec}}
\newcommand{\what}{\widehat{\wvec}}
\newcommand{\Sighat}{\widehat{\Sigma}}
\newcommand{\basis}[2]{#1_1,#1_2,\ldots,#1_{#2}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter">
<div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="frontmatter-4.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li class="toc-item toc-dedication"><div class="toc-title-box"><a href="frontmatter-5.html" class="internal"><span class="title">Dedication</span></a></div></li>
<li class="toc-item toc-acknowledgement"><div class="toc-title-box"><a href="frontmatter-6.html" class="internal"><span class="title">Acknowledgements</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="frontmatter-7.html" class="internal"><span class="title">Our goals</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="frontmatter-8.html" class="internal"><span class="title">A note on the print version</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap1.html" class="internal"><span class="codenumber">1</span> <span class="title">Systems of equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-expect.html" class="internal"><span class="codenumber">1.1</span> <span class="title">What can we expect</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-expect.html#sec-expect-3" class="internal"><span class="codenumber">1.1.1</span> <span class="title">Some simple examples</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-expect.html#sec-expect-4" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Systems of linear equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-expect.html#sec-expect-5" class="internal"><span class="codenumber">1.1.3</span> <span class="title">Summary</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-finding-solutions.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Finding solutions to linear systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-finding-solutions.html#sec-finding-solutions-3" class="internal"><span class="codenumber">1.2.1</span> <span class="title">Gaussian elimination</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-finding-solutions.html#sec-finding-solutions-4" class="internal"><span class="codenumber">1.2.2</span> <span class="title">Augmented matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-finding-solutions.html#sec-finding-solutions-5" class="internal"><span class="codenumber">1.2.3</span> <span class="title">Reduced row echelon form</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-finding-solutions.html#sec-finding-solutions-6" class="internal"><span class="codenumber">1.2.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-finding-solutions.html#sec-finding-solutions-7" class="internal"><span class="codenumber">1.2.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-sage-introduction.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Computation with Sage</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sage-introduction.html#sec-sage-introduction-3" class="internal"><span class="codenumber">1.3.1</span> <span class="title">Introduction to Sage</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sage-introduction.html#sec-sage-introduction-4" class="internal"><span class="codenumber">1.3.2</span> <span class="title">Sage and matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sage-introduction.html#subsec-compute-effort" class="internal"><span class="codenumber">1.3.3</span> <span class="title">Computational effort</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-sage-introduction.html#sec-sage-introduction-6" class="internal"><span class="codenumber">1.3.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-sage-introduction.html#sec-sage-introduction-7" class="internal"><span class="codenumber">1.3.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-pivots.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Pivots and their influence on solution spaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-pivots.html#sec-pivots-3" class="internal"><span class="codenumber">1.4.1</span> <span class="title">The existence of solutions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-pivots.html#sec-pivots-4" class="internal"><span class="codenumber">1.4.2</span> <span class="title">The uniqueness of solutions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-pivots.html#sec-pivots-5" class="internal"><span class="codenumber">1.4.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-pivots.html#sec-pivots-6" class="internal"><span class="codenumber">1.4.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap2.html" class="internal"><span class="codenumber">2</span> <span class="title">Vectors, matrices, and linear combinations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-vectors-lin-combs.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Vectors and linear combinations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vectors-lin-combs.html#sec-vectors-lin-combs-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">Vectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vectors-lin-combs.html#sec-vectors-lin-combs-4" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Linear combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vectors-lin-combs.html#sec-vectors-lin-combs-5" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-vectors-lin-combs.html#sec-vectors-lin-combs-6" class="internal"><span class="codenumber">2.1.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-matrices-lin-combs.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Matrix multiplication and linear combinations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrices-lin-combs.html#sec-matrices-lin-combs-3" class="internal"><span class="codenumber">2.2.1</span> <span class="title">Scalar multiplication and addition of matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrices-lin-combs.html#sec-matrices-lin-combs-4" class="internal"><span class="codenumber">2.2.2</span> <span class="title">Matrix-vector multiplication and linear combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrices-lin-combs.html#sec-matrices-lin-combs-5" class="internal"><span class="codenumber">2.2.3</span> <span class="title">Matrix-vector multiplication and linear systems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrices-lin-combs.html#sec-matrices-lin-combs-6" class="internal"><span class="codenumber">2.2.4</span> <span class="title">Matrix-matrix products</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrices-lin-combs.html#sec-matrices-lin-combs-7" class="internal"><span class="codenumber">2.2.5</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-matrices-lin-combs.html#sec-matrices-lin-combs-8" class="internal"><span class="codenumber">2.2.6</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-span.html" class="internal"><span class="codenumber">2.3</span> <span class="title">The span of a set of vectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-span.html#sec-span-3" class="internal"><span class="codenumber">2.3.1</span> <span class="title">The span of a set of vectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-span.html#sec-span-4" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Pivot positions and span</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-span.html#sec-span-5" class="internal"><span class="codenumber">2.3.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-span.html#sec-span-6" class="internal"><span class="codenumber">2.3.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-linear-dep.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Linear independence</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-dep.html#sec-linear-dep-3" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Linear dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-dep.html#sec-linear-dep-4" class="internal"><span class="codenumber">2.4.2</span> <span class="title">How to recognize linear dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-dep.html#sec-linear-dep-5" class="internal"><span class="codenumber">2.4.3</span> <span class="title">Homogeneous equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-dep.html#sec-linear-dep-6" class="internal"><span class="codenumber">2.4.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-linear-dep.html#sec-linear-dep-7" class="internal"><span class="codenumber">2.4.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-linear-trans.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Matrix transformations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-trans.html#sec-linear-trans-3" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Matrix transformations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-trans.html#sec-linear-trans-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Composing matrix transformations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-trans.html#subsec-dynamical-systems" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Discrete Dynamical Systems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-linear-trans.html#sec-linear-trans-6" class="internal"><span class="codenumber">2.5.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-linear-trans.html#sec-linear-trans-7" class="internal"><span class="codenumber">2.5.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-transforms-geom.html" class="internal"><span class="codenumber">2.6</span> <span class="title">The geometry of matrix transformations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transforms-geom.html#sec-transforms-geom-3" class="internal"><span class="codenumber">2.6.1</span> <span class="title">The geometry of <span class="process-math">\(2\times2\)</span> matrix transformations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transforms-geom.html#sec-transforms-geom-4" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Matrix transformations and computer animation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transforms-geom.html#sec-transforms-geom-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-transforms-geom.html#sec-transforms-geom-6" class="internal"><span class="codenumber">2.6.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap3.html" class="internal"><span class="codenumber">3</span> <span class="title">Invertibility, bases, and coordinate systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-matrix-inverse.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Invertibility</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrix-inverse.html#subsec-invertible-matrices" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Invertible matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrix-inverse.html#sec-matrix-inverse-4" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Solving equations with an inverse</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrix-inverse.html#subsec-triangular-invertible" class="internal"><span class="codenumber">3.1.3</span> <span class="title">Triangular matrices and Gaussian elimination</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-matrix-inverse.html#sec-matrix-inverse-6" class="internal"><span class="codenumber">3.1.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-matrix-inverse.html#sec-matrix-inverse-7" class="internal"><span class="codenumber">3.1.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-bases.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Bases and coordinate systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bases.html#sec-bases-3" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Bases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bases.html#sec-bases-4" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Coordinate systems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bases.html#sec-bases-5" class="internal"><span class="codenumber">3.2.3</span> <span class="title">Examples of bases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-bases.html#sec-bases-6" class="internal"><span class="codenumber">3.2.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-bases.html#sec-bases-7" class="internal"><span class="codenumber">3.2.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-jpeg.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Image compression</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-jpeg.html#sec-jpeg-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Color models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-jpeg.html#sec-jpeg-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">The JPEG compression algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-jpeg.html#sec-jpeg-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-jpeg.html#sec-jpeg-6" class="internal"><span class="codenumber">3.3.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-determinants.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Determinants</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-determinants.html#sec-determinants-3" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Determinants of <span class="process-math">\(2\times2\)</span> matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-determinants.html#sec-determinants-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Determinants and invertibility</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-determinants.html#sec-determinants-5" class="internal"><span class="codenumber">3.4.3</span> <span class="title">Cofactor expansions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-determinants.html#sec-determinants-6" class="internal"><span class="codenumber">3.4.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-determinants.html#sec-determinants-7" class="internal"><span class="codenumber">3.4.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-subspaces.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Subspaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-subspaces.html#sec-subspaces-3" class="internal"><span class="codenumber">3.5.1</span> <span class="title">Subspaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-subspaces.html#sec-subspaces-4" class="internal"><span class="codenumber">3.5.2</span> <span class="title">The column space of <span class="process-math">\(A\)</span></span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-subspaces.html#sec-subspaces-5" class="internal"><span class="codenumber">3.5.3</span> <span class="title">The null space of <span class="process-math">\(A\)</span></span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-subspaces.html#sec-subspaces-6" class="internal"><span class="codenumber">3.5.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-subspaces.html#sec-subspaces-7" class="internal"><span class="codenumber">3.5.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap4.html" class="internal"><span class="codenumber">4</span> <span class="title">Eigenvalues and eigenvectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-eigen-intro.html" class="internal"><span class="codenumber">4.1</span> <span class="title">An introduction to eigenvalues and eigenvectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-intro.html#sec-eigen-intro-3" class="internal"><span class="codenumber">4.1.1</span> <span class="title">A few examples</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-intro.html#subsec-eigen-use" class="internal"><span class="codenumber">4.1.2</span> <span class="title">The usefulness of eigenvalues and eigenvectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-intro.html#sec-eigen-intro-5" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-eigen-intro.html#sec-eigen-intro-6" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-eigen-find.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Finding eigenvalues and eigenvectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-find.html#sec-eigen-find-3" class="internal"><span class="codenumber">4.2.1</span> <span class="title">The characteristic polynomial</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-find.html#sec-eigen-find-4" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Finding eigenvectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-find.html#sec-eigen-find-5" class="internal"><span class="codenumber">4.2.3</span> <span class="title">The characteristic polynomial and the dimension of eigenspaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-find.html#sec-eigen-find-6" class="internal"><span class="codenumber">4.2.4</span> <span class="title">Using Sage to find eigenvalues and eigenvectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-find.html#sec-eigen-find-7" class="internal"><span class="codenumber">4.2.5</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-eigen-find.html#sec-eigen-find-8" class="internal"><span class="codenumber">4.2.6</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-eigen-diag.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Diagonalization, similarity, and powers of a matrix</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-diag.html#sec-eigen-diag-3" class="internal"><span class="codenumber">4.3.1</span> <span class="title">Diagonalization of matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-diag.html#sec-eigen-diag-4" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Powers of a diagonalizable matrix</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-diag.html#sec-eigen-diag-5" class="internal"><span class="codenumber">4.3.3</span> <span class="title">Similarity and complex eigenvalues</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-eigen-diag.html#sec-eigen-diag-6" class="internal"><span class="codenumber">4.3.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-eigen-diag.html#sec-eigen-diag-7" class="internal"><span class="codenumber">4.3.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-dynamical.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Dynamical systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dynamical.html#sec-dynamical-3" class="internal"><span class="codenumber">4.4.1</span> <span class="title">A first example</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dynamical.html#sec-dynamical-4" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Classifying dynamical systems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dynamical.html#sec-dynamical-5" class="internal"><span class="codenumber">4.4.3</span> <span class="title">A <span class="process-math">\(3\times3\)</span> system</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dynamical.html#sec-dynamical-6" class="internal"><span class="codenumber">4.4.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-dynamical.html#sec-dynamical-7" class="internal"><span class="codenumber">4.4.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-stochastic.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Markov chains and Google’s PageRank algorithm</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-stochastic.html#sec-stochastic-3" class="internal"><span class="codenumber">4.5.1</span> <span class="title">A first example</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-stochastic.html#sec-stochastic-4" class="internal"><span class="codenumber">4.5.2</span> <span class="title">Markov chains</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-stochastic.html#subsec-google" class="internal"><span class="codenumber">4.5.3</span> <span class="title">Google’s PageRank algorithm</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-stochastic.html#sec-stochastic-6" class="internal"><span class="codenumber">4.5.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-stochastic.html#sec-stochastic-7" class="internal"><span class="codenumber">4.5.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap5.html" class="internal"><span class="codenumber">5</span> <span class="title">Linear algebra and computing</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-gaussian-revisited.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Gaussian elimination revisited</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gaussian-revisited.html#subsec-partial-pivot" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Partial pivoting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gaussian-revisited.html#sec-gaussian-revisited-4" class="internal"><span class="codenumber">5.1.2</span> <span class="title"><span class="process-math">\(LU\)</span> factorizations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gaussian-revisited.html#sec-gaussian-revisited-5" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-gaussian-revisited.html#sec-gaussian-revisited-6" class="internal"><span class="codenumber">5.1.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-power-method.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Finding eigenvectors numerically</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-power-method.html#sec-power-method-3" class="internal"><span class="codenumber">5.2.1</span> <span class="title">The power method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-power-method.html#sec-power-method-4" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Finding other eigenvalues</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-power-method.html#sec-power-method-5" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-power-method.html#sec-power-method-6" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="chap6.html" class="internal"><span class="codenumber">6</span> <span class="title">Orthogonality and Least Squares</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-dot-product.html" class="internal"><span class="codenumber">6.1</span> <span class="title">The dot product</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dot-product.html#sec-dot-product-3" class="internal"><span class="codenumber">6.1.1</span> <span class="title">The geometry of the dot product</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dot-product.html#sec-dot-product-4" class="internal"><span class="codenumber">6.1.2</span> <span class="title"><span class="process-math">\(k\)</span>-means clustering</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-dot-product.html#sec-dot-product-5" class="internal"><span class="codenumber">6.1.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-dot-product.html#sec-dot-product-6" class="internal"><span class="codenumber">6.1.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-transpose.html" class="internal"><span class="codenumber">6.2</span> <span class="title">Orthogonal complements and the matrix transpose</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transpose.html#sec-transpose-3" class="internal"><span class="codenumber">6.2.1</span> <span class="title">Orthogonal complements</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transpose.html#sec-transpose-4" class="internal"><span class="codenumber">6.2.2</span> <span class="title">The matrix transpose</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transpose.html#sec-transpose-5" class="internal"><span class="codenumber">6.2.3</span> <span class="title">Properties of the matrix transpose</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transpose.html#sec-transpose-6" class="internal"><span class="codenumber">6.2.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-transpose.html#sec-transpose-7" class="internal"><span class="codenumber">6.2.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-orthogonal-bases.html" class="internal"><span class="codenumber">6.3</span> <span class="title">Orthogonal bases and projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal-bases.html#sec-orthogonal-bases-3" class="internal"><span class="codenumber">6.3.1</span> <span class="title">Orthogonal sets</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal-bases.html#sec-orthogonal-bases-4" class="internal"><span class="codenumber">6.3.2</span> <span class="title">Orthogonal projections</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal-bases.html#sec-orthogonal-bases-5" class="internal"><span class="codenumber">6.3.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-orthogonal-bases.html#sec-orthogonal-bases-6" class="internal"><span class="codenumber">6.3.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-gram-schmidt.html" class="internal"><span class="codenumber">6.4</span> <span class="title">Finding orthogonal bases</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gram-schmidt.html#sec-gram-schmidt-3" class="internal"><span class="codenumber">6.4.1</span> <span class="title">Gram-Schmidt orthogonalization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gram-schmidt.html#sec-gram-schmidt-4" class="internal"><span class="codenumber">6.4.2</span> <span class="title"><span class="process-math">\(QR\)</span> factorizations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-gram-schmidt.html#sec-gram-schmidt-5" class="internal"><span class="codenumber">6.4.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-gram-schmidt.html#sec-gram-schmidt-6" class="internal"><span class="codenumber">6.4.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec-least-squares.html" class="internal"><span class="codenumber">6.5</span> <span class="title">Orthogonal least squares</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-least-squares.html#sec-least-squares-3" class="internal"><span class="codenumber">6.5.1</span> <span class="title">A first example</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-least-squares.html#sec-least-squares-4" class="internal"><span class="codenumber">6.5.2</span> <span class="title">Solving least-squares problems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-least-squares.html#sec-least-squares-5" class="internal"><span class="codenumber">6.5.3</span> <span class="title">Using <span class="process-math">\(QR\)</span> factorizations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-least-squares.html#sec-least-squares-6" class="internal"><span class="codenumber">6.5.4</span> <span class="title">Polynomial Regression</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-least-squares.html#sec-least-squares-7" class="internal"><span class="codenumber">6.5.5</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-least-squares.html#sec-least-squares-8" class="internal"><span class="codenumber">6.5.6</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap7.html" class="internal"><span class="codenumber">7</span> <span class="title">Singular value decompositions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-symmetric-matrices.html" class="internal"><span class="codenumber">7.1</span> <span class="title">Symmetric matrices and variance</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-symmetric-matrices.html#sec-symmetric-matrices-3" class="internal"><span class="codenumber">7.1.1</span> <span class="title">Symmetric matrices and orthogonal diagonalization</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-symmetric-matrices.html#sec-symmetric-matrices-4" class="internal"><span class="codenumber">7.1.2</span> <span class="title">Variance</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-symmetric-matrices.html#sec-symmetric-matrices-5" class="internal"><span class="codenumber">7.1.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-symmetric-matrices.html#sec-symmetric-matrices-6" class="internal"><span class="codenumber">7.1.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-quadratic-forms.html" class="internal"><span class="codenumber">7.2</span> <span class="title">Quadratic forms</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-quadratic-forms.html#sec-quadratic-forms-3" class="internal"><span class="codenumber">7.2.1</span> <span class="title">Quadratic forms</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-quadratic-forms.html#sec-quadratic-forms-4" class="internal"><span class="codenumber">7.2.2</span> <span class="title">Definite symmetric matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-quadratic-forms.html#sec-quadratic-forms-5" class="internal"><span class="codenumber">7.2.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-quadratic-forms.html#sec-quadratic-forms-6" class="internal"><span class="codenumber">7.2.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-pca.html" class="internal"><span class="codenumber">7.3</span> <span class="title">Principal Component Analysis</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-pca.html#sec-pca-3" class="internal"><span class="codenumber">7.3.1</span> <span class="title">Principal Component Analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-pca.html#sec-pca-4" class="internal"><span class="codenumber">7.3.2</span> <span class="title">Using Principal Component Analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-pca.html#sec-pca-5" class="internal"><span class="codenumber">7.3.3</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-pca.html#sec-pca-6" class="internal"><span class="codenumber">7.3.4</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-svd-intro.html" class="internal"><span class="codenumber">7.4</span> <span class="title">Singular Value Decompositions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-intro.html#sec-svd-intro-3" class="internal"><span class="codenumber">7.4.1</span> <span class="title">Finding singular value decompositions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-intro.html#sec-svd-intro-4" class="internal"><span class="codenumber">7.4.2</span> <span class="title">The structure of singular value decompositions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-intro.html#sec-svd-intro-5" class="internal"><span class="codenumber">7.4.3</span> <span class="title">Reduced singular value decompositions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-intro.html#sec-svd-intro-6" class="internal"><span class="codenumber">7.4.4</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-svd-intro.html#sec-svd-intro-7" class="internal"><span class="codenumber">7.4.5</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-svd-uses.html" class="internal"><span class="codenumber">7.5</span> <span class="title">Using Singular Value Decompositions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-3" class="internal"><span class="codenumber">7.5.1</span> <span class="title">Least-squares problems</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-4" class="internal"><span class="codenumber">7.5.2</span> <span class="title">Rank <span class="process-math">\(k\)</span> approximations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-5" class="internal"><span class="codenumber">7.5.3</span> <span class="title">Principal component analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-6" class="internal"><span class="codenumber">7.5.4</span> <span class="title">Image compressing and denoising</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-7" class="internal"><span class="codenumber">7.5.5</span> <span class="title">Analyzing Supreme Court cases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-8" class="internal"><span class="codenumber">7.5.6</span> <span class="title">Summary</span></a></div></li>
<li class="toc-item toc-exercises"><div class="toc-title-box"><a href="sec-svd-uses.html#sec-svd-uses-9" class="internal"><span class="codenumber">7.5.7</span> <span class="title">Exercises</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter">
<div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Back Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-appendix"><div class="toc-title-box"><a href="app-sage-reference.html" class="internal"><span class="codenumber">A</span> <span class="title">Sage Reference</span></a></div></li>
<li class="toc-item toc-index"><div class="toc-title-box"><a href="backmatter-3.html" class="internal"><span class="title">Index</span></a></div></li>
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="backmatter-4.html" class="internal"><span class="title">Colophon</span></a></div></li>
</ul>
</li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-least-squares"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">6.5</span><span class="space"> </span><span class="title">Orthogonal least squares</span>
</h2>
<section class="introduction" id="sec-least-squares-2"><div class="para" id="sec-least-squares-2-1">Suppose we collect some data when performing an experiment and plot it as shown on the left of <a href="sec-least-squares.html#lst-squares-intro" class="xref" data-knowl="./knowl/xref/lst-squares-intro.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 6.5.1">Figure 6.5.1</a>.  Notice that there is no line on which all the points lie; in fact, it would be surprising if there were since we can expect some uncertainty in the measurements recorded.  There does, however, appear to be a line, as shown on the right, on which the points <em class="emphasis">almost</em> lie.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="lst-squares-intro"><div class="sidebyside"><div class="sbsrow" style="margin-left:2.5%;margin-right:2.5%;">
<div class="sbspanel top" style="width:47.3684210526316%;"><img src="external/images/lst-squares-1.svg" role="img" class="contained"></div>
<div class="sbspanel top" style="width:47.3684210526316%;"><img src="external/images/lst-squares-2.svg" role="img" class="contained"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.5.1<span class="period">.</span></span><span class="space"> </span>A collection of points and a line approximating the linear relationship implied by them.<div class="autopermalink" data-description="Figure 6.5.1"><a href="#lst-squares-intro" title="Copy heading and permalink for Figure 6.5.1" aria-label="Copy heading and permalink for Figure 6.5.1">🔗</a></div></figcaption></figure><div class="para" id="sec-least-squares-2-3">In this section, we’ll explore how the techniques developed in this chapter enable us to find the line that best approximates the data.  More specifically, we’ll see how the search for a line passing through the data points leads to an inconsistent system <span class="process-math">\(A\xvec=\bvec\text{.}\)</span>  Since we are unable to find a solution, we instead seek the vector <span class="process-math">\(\xvec\)</span> where <span class="process-math">\(A\xvec\)</span> is as close as possible to <span class="process-math">\(\bvec\text{.}\)</span> Orthogonal projection gives us just the right tool for doing this.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-2-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="exploration project-like" id="ula-preview-6-5"><h3 class="heading">
<span class="type">Preview Activity</span><span class="space"> </span><span class="codenumber">6.5.1</span><span class="period">.</span>
</h3>
<article class="task exercise-like" id="ula-preview-6-5-a"><h4 class="heading"><span class="codenumber">(a)</span></h4>
<div class="para logical" id="ula-preview-6-5-a-1-1">
<div class="para">Is there a solution to the equation <span class="process-math">\(A\xvec=\bvec\)</span> where <span class="process-math">\(A\)</span> and <span class="process-math">\(\bvec\)</span> are such that</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{bmatrix}
1 \amp 2 \\
2 \amp 5 \\
-1 \amp 0 \\
\end{bmatrix}
\xvec = \threevec5{-3}{-1}\text{.}
\end{equation*}
</div>
<div class="para"><div id="ula-preview-6-5-a-1-1-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div></div>
<div class="autopermalink" data-description="Paragraph"><a href="#ula-preview-6-5-a-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Task 6.5.1.a"><a href="#ula-preview-6-5-a" title="Copy heading and permalink for Task 6.5.1.a" aria-label="Copy heading and permalink for Task 6.5.1.a">🔗</a></div></article><article class="task exercise-like" id="ula-preview-6-5-b"><h4 class="heading"><span class="codenumber">(b)</span></h4>
<div class="para" id="ula-preview-6-5-b-1-1">We know that <span class="process-math">\(\threevec12{-1}\)</span> and <span class="process-math">\(\threevec250\)</span> form a basis for <span class="process-math">\(\col(A)\text{.}\)</span>  Find an orthogonal basis for <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ula-preview-6-5-b-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Task 6.5.1.b"><a href="#ula-preview-6-5-b" title="Copy heading and permalink for Task 6.5.1.b" aria-label="Copy heading and permalink for Task 6.5.1.b">🔗</a></div></article><article class="task exercise-like" id="ula-preview-6-5-c"><h4 class="heading"><span class="codenumber">(c)</span></h4>
<div class="para" id="ula-preview-6-5-c-1-1">Find the orthogonal projection <span class="process-math">\(\widehat\bvec\)</span> of <span class="process-math">\(\bvec\)</span> onto <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ula-preview-6-5-c-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Task 6.5.1.c"><a href="#ula-preview-6-5-c" title="Copy heading and permalink for Task 6.5.1.c" aria-label="Copy heading and permalink for Task 6.5.1.c">🔗</a></div></article><article class="task exercise-like" id="ula-preview-6-5-d"><h4 class="heading"><span class="codenumber">(d)</span></h4>
<div class="para" id="ula-preview-6-5-d-1-1">Explain why the equation <span class="process-math">\(A\xvec=\widehat\bvec\)</span> must be consistent and then find its solution.<div class="autopermalink" data-description="Paragraph"><a href="#ula-preview-6-5-d-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Task 6.5.1.d"><a href="#ula-preview-6-5-d" title="Copy heading and permalink for Task 6.5.1.d" aria-label="Copy heading and permalink for Task 6.5.1.d">🔗</a></div></article><div class="autopermalink" data-description="Preview Activity 6.5.1"><a href="#ula-preview-6-5" title="Copy heading and permalink for Preview Activity 6.5.1" aria-label="Copy heading and permalink for Preview Activity 6.5.1">🔗</a></div></article></section><section class="subsection" id="sec-least-squares-3"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.5.1</span><span class="space"> </span><span class="title">A first example</span>
</h3>
<div class="para" id="sec-least-squares-3-2">When we’ve encountered inconsistent systems in the past, we’ve simply said there is no solution and moved on.  The preview activity, however, shows how we can find approximate solutions to an inconsistent system: if there are no solutions to <span class="process-math">\(A\xvec = \bvec\text{,}\)</span> we instead solve the consistent system <span class="process-math">\(A\xvec = \bhat\text{,}\)</span> the orthogonal projection of <span class="process-math">\(\bvec\)</span> onto <span class="process-math">\(\col(A)\text{.}\)</span>  As we’ll see, this solution is, in a specific sense, the best possible.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="activity project-like" id="sec-least-squares-3-3"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.5.2</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-least-squares-3-3-1-1">
<div class="para">Suppose we have three data points <span class="process-math">\((1,1)\text{,}\)</span> <span class="process-math">\((2,1)\text{,}\)</span> and <span class="process-math">\((3,3)\)</span> and that we would like to find a line passing through them.</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-3-3-1-1-4">
<li id="sec-least-squares-3-3-1-1-4-1">
<div class="para" id="sec-least-squares-3-3-1-1-4-1-1">Plot these three points in <a href="sec-least-squares.html#fig-ls-empty" class="xref" data-knowl="./knowl/xref/fig-ls-empty.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 6.5.2">Figure 6.5.2</a>.  Are you able to draw a line that passes through all three points? <figure class="figure figure-like" id="fig-ls-empty"><div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/empty-ls.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.5.2<span class="period">.</span></span><span class="space"> </span>Plot the three data points here.<div class="autopermalink" data-description="Figure 6.5.2"><a href="#fig-ls-empty" title="Copy heading and permalink for Figure 6.5.2" aria-label="Copy heading and permalink for Figure 6.5.2">🔗</a></div></figcaption></figure><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item a"><a href="#sec-least-squares-3-3-1-1-4-1" title="Copy heading and permalink for Item a" aria-label="Copy heading and permalink for Item a">🔗</a></div>
</li>
<li id="sec-least-squares-3-3-1-1-4-2">
<div class="para" id="sec-least-squares-3-3-1-1-4-2-1">Remember that the equation of a line can be written as <span class="process-math">\(b + mx=y\)</span> where <span class="process-math">\(m\)</span> is the slope and <span class="process-math">\(b\)</span> is the <span class="process-math">\(y\)</span>-intercept.  We will try to find <span class="process-math">\(b\)</span> and <span class="process-math">\(m\)</span> so that the three points lie on the line.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-3-3-1-1-4-2-2">The first data point <span class="process-math">\((1,1)\)</span> gives an equation for <span class="process-math">\(b\)</span> and <span class="process-math">\(m\text{.}\)</span>  In particular, we know that when <span class="process-math">\(x=1\text{,}\)</span> then <span class="process-math">\(y=1\)</span> so we have <span class="process-math">\(b + m(1) = 1\)</span> or <span class="process-math">\(b + m = 1\text{.}\)</span>  Use the other two data points to create a linear system describing <span class="process-math">\(m\)</span> and <span class="process-math">\(b\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item b"><a href="#sec-least-squares-3-3-1-1-4-2" title="Copy heading and permalink for Item b" aria-label="Copy heading and permalink for Item b">🔗</a></div>
</li>
<li id="sec-least-squares-3-3-1-1-4-3">
<div class="para" id="sec-least-squares-3-3-1-1-4-3-1">We have obtained a linear system having three equations, one from each data point, for the two unknowns <span class="process-math">\(b\)</span> and <span class="process-math">\(m\text{.}\)</span> Identify a matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\)</span> so that the system has the form <span class="process-math">\(A\xvec=\bvec\text{,}\)</span> where <span class="process-math">\(\xvec=\ctwovec bm\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-3-3-1-1-4-3-2">Notice that the unknown vector <span class="process-math">\(\xvec=\ctwovec bm\)</span> describes the line that we seek.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c"><a href="#sec-least-squares-3-3-1-1-4-3" title="Copy heading and permalink for Item c" aria-label="Copy heading and permalink for Item c">🔗</a></div>
</li>
<li id="sec-least-squares-3-3-1-1-4-4">
<div class="para" id="sec-least-squares-3-3-1-1-4-4-1">Is there a solution to this linear system?  How does this question relate to your attempt to draw a line through the three points above? <div id="sec-least-squares-3-3-1-1-4-4-1-1" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item d"><a href="#sec-least-squares-3-3-1-1-4-4" title="Copy heading and permalink for Item d" aria-label="Copy heading and permalink for Item d">🔗</a></div>
</li>
<li id="sec-least-squares-3-3-1-1-4-5">
<div class="para" id="sec-least-squares-3-3-1-1-4-5-1">Since this system is inconsistent, we know that <span class="process-math">\(\bvec\)</span> is not in the column space <span class="process-math">\(\col(A)\text{.}\)</span> Find an orthogonal basis for <span class="process-math">\(\col(A)\)</span> and use it to find the orthogonal projection <span class="process-math">\(\widehat\bvec\)</span> of <span class="process-math">\(\bvec\)</span> onto <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item e"><a href="#sec-least-squares-3-3-1-1-4-5" title="Copy heading and permalink for Item e" aria-label="Copy heading and permalink for Item e">🔗</a></div>
</li>
<li id="sec-least-squares-3-3-1-1-4-6">
<div class="para" id="sec-least-squares-3-3-1-1-4-6-1">Since <span class="process-math">\(\widehat\bvec\)</span> is in <span class="process-math">\(\col(A)\text{,}\)</span> the equation <span class="process-math">\(A\xvec = \widehat\bvec\)</span> is consistent.  Find its solution <span class="process-math">\(\xvec = \ctwovec{b}{m}\)</span> and sketch the line <span class="process-math">\(y=b + mx\)</span> in <a href="sec-least-squares.html#fig-ls-empty" class="xref" data-knowl="./knowl/xref/fig-ls-empty.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 6.5.2">Figure 6.5.2</a>.  We say that this is the line of best fit.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1-4-6-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item f"><a href="#sec-least-squares-3-3-1-1-4-6" title="Copy heading and permalink for Item f" aria-label="Copy heading and permalink for Item f">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-3-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Activity 6.5.2"><a href="#sec-least-squares-3-3" title="Copy heading and permalink for Activity 6.5.2" aria-label="Copy heading and permalink for Activity 6.5.2">🔗</a></div></article><div class="para logical" id="sec-least-squares-3-4">
<div class="para">This activity illustrates the idea behind a technique known as <em class="emphasis">orthogonal least squares</em>, which we have been working toward throughout this chapter.  If the data points are denoted as <span class="process-math">\((x_i, y_i)\text{,}\)</span> we construct the matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\)</span> as</div>
<div class="displaymath process-math">
\begin{equation*}
A =
\begin{bmatrix}
1 \amp x_1 \\
1 \amp x_2 \\
1 \amp x_3 \\
\end{bmatrix},\hspace{24pt}
\bvec = \threevec{y_1}{y_2}{y_3}\text{.}
\end{equation*}
</div>
<div class="para">With the vector <span class="process-math">\(\xvec=\ctwovec bm\)</span> representing the line <span class="process-math">\(b+mx = y\text{,}\)</span> we see that the equation <span class="process-math">\(A\xvec=\bvec\)</span> describes a line passing through all the data points.  In our activity, it is visually apparent that there is no such line, which agrees with the fact that the equation <span class="process-math">\(A\xvec=\bvec\)</span> is inconsistent.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-3-5">Remember that <span class="process-math">\(\bhat\text{,}\)</span> the orthogonal projection of <span class="process-math">\(\bvec\)</span> onto <span class="process-math">\(\col(A)\text{,}\)</span> is the closest vector in <span class="process-math">\(\col(A)\)</span> to <span class="process-math">\(\bvec\text{.}\)</span>  Therefore, when we solve the equation <span class="process-math">\(A\xvec=\bhat\text{,}\)</span> we are finding the vector <span class="process-math">\(\xvec\)</span> so that <span class="process-math">\(A\xvec = 
\threevec{b+mx_1}{b+mx_2}{b+mx_3}\)</span> is as close to <span class="process-math">\(\bvec=\threevec{y_1}{y_2}{y_3}\)</span> as possible.  Let’s think about what this means within the context of this problem.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-least-squares-3-6">
<div class="para">The difference <span class="process-math">\(\bvec-A\xvec =
\threevec{y_1-(b+mx_1)}{y_2-(b+mx_2)}{y_3-(b+mx_3)}\)</span> so that the square of the distance between <span class="process-math">\(A\xvec\)</span> and <span class="process-math">\(\bvec\)</span> is</div>
<div class="displaymath process-math" id="sec-least-squares-3-6-4">
\begin{align*}
\len{\bvec - A\xvec}^2 \amp =\\
\amp \left(y_1-(b+mx_1)\right)^2 + 
\left(y_2-(b+mx_2)\right)^2 +
\left(y_3-(b+mx_3)\right)^2\text{.}
\end{align*}
</div>
<div class="para">Our approach finds the values for <span class="process-math">\(b\)</span> and <span class="process-math">\(m\)</span> that make this sum of squares as small as possible, which is why we call this a <em class="emphasis">least-squares</em> problem.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-3-7">Drawing the line defined by the vector <span class="process-math">\(\xvec=\ctwovec bm\text{,}\)</span> the quantity <span class="process-math">\(y_i - (b + mx_i)\)</span> reflects the vertical distance between the line and the data point <span class="process-math">\((x_i, y_i)\text{,}\)</span> as shown in <a href="sec-least-squares.html#fig-least-squares-def" class="xref" data-knowl="./knowl/xref/fig-least-squares-def.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 6.5.5">Figure 6.5.5</a>.  Seen in this way, the square of the distance <span class="process-math">\(\len{\bvec-A\xvec}^2\)</span> is a measure of how much the line defined by the vector <span class="process-math">\(\xvec\)</span> misses the data points.  The solution to the least-squares problem is the line that misses the data points by the smallest amount possible.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-3-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="fig-least-squares-def"><div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/line-regress-1.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.5.5<span class="period">.</span></span><span class="space"> </span>The solution of the least-squares problem and the vertical distances between the line and the data points.<div class="autopermalink" data-description="Figure 6.5.5"><a href="#fig-least-squares-def" title="Copy heading and permalink for Figure 6.5.5" aria-label="Copy heading and permalink for Figure 6.5.5">🔗</a></div></figcaption></figure><div class="autopermalink" data-description="Subsection 6.5.1: A first example"><a href="#sec-least-squares-3" title="Copy heading and permalink for Subsection 6.5.1: A first example" aria-label="Copy heading and permalink for Subsection 6.5.1: A first example">🔗</a></div></section><section class="subsection" id="sec-least-squares-4"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.5.2</span><span class="space"> </span><span class="title">Solving least-squares problems</span>
</h3>
<div class="para" id="sec-least-squares-4-2">Now that we’ve seen an example of what we’re trying to accomplish, let’s put this technique into a more general framework.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-4-3">Given an inconsistent system <span class="process-math">\(A\xvec = \bvec\text{,}\)</span> we seek the vector <span class="process-math">\(\xvec\)</span> that minimizes the distance from <span class="process-math">\(A\xvec\)</span> to <span class="process-math">\(\bvec\text{.}\)</span>  In other words, <span class="process-math">\(\xvec\)</span> satisfies <span class="process-math">\(A\xvec = \widehat\bvec\text{,}\)</span> where <span class="process-math">\(\bhat\)</span> is the orthogonal projection of <span class="process-math">\(\bvec\)</span> onto the column space <span class="process-math">\(\col(A)\text{.}\)</span>  We know the equation <span class="process-math">\(A\xvec=\bhat\)</span> is consistent since <span class="process-math">\(\bhat\)</span> is in <span class="process-math">\(\col(A)\text{,}\)</span> and we know there is only one solution if we assume that the columns of <span class="process-math">\(A\)</span> are linearly independent.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-4-4">We will usually denote the solution of <span class="process-math">\(A\xvec = \bhat\)</span> by <span class="process-math">\(\xhat\)</span> and call this vector the <em class="emphasis">least-squares approximate solution</em> of <span class="process-math">\(A\xvec=\bvec\)</span> to distinguish it from a (possibly non-existent) solution of <span class="process-math">\(A\xvec=\bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-least-squares-4-5">
<div class="para">There is an alternative method for finding <span class="process-math">\(\xhat\)</span> that does not involve first finding the orthogonal projection <span class="process-math">\(\bhat\text{.}\)</span> Remember that <span class="process-math">\(\bhat\)</span> is defined by the fact that <span class="process-math">\(\widehat\bvec - \bvec\)</span> is orthogonal to <span class="process-math">\(\col(A)\text{.}\)</span>  In other words, <span class="process-math">\(\bhat-\bvec\)</span> is in the orthogonal complement <span class="process-math">\(\col(A)^\perp\text{,}\)</span> which <a href="sec-transpose.html#prop-col-orthog" class="xref" data-knowl="./knowl/xref/prop-col-orthog.html" data-reveal-label="Reveal" data-close-label="Close" title="Proposition 6.2.10">Proposition 6.2.10</a> tells us is the same as <span class="process-math">\(\nul(A^T)\text{.}\)</span>  Since <span class="process-math">\(\bhat-\bvec\)</span> is in <span class="process-math">\(\nul(A^T)\text{,}\)</span> it follows that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/prop-col-orthog.html">
\begin{equation*}
A^T(\widehat\bvec-\bvec) = \zerovec\text{.}
\end{equation*}
</div>
<div class="para">Because the least-squares approximate solution is the vector <span class="process-math">\(\xhat\)</span> such that <span class="process-math">\(A\xhat =
\bhat\text{,}\)</span> we can rearrange this equation to see that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/prop-col-orthog.html" id="sec-least-squares-4-5-15">
\begin{align*}
A^T(A\xhat - \bvec) \amp = \zerovec\\
A^TA\xhat - A^T\bvec \amp = \zerovec\\
A^TA\xhat \amp = A^T\bvec\text{.}
\end{align*}
</div>
<div class="para"> This equation is called the <em class="emphasis">normal equation</em>, and we have the following proposition.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="proposition theorem-like" id="sec-least-squares-4-6"><h4 class="heading">
<span class="type">Proposition</span><span class="space"> </span><span class="codenumber">6.5.6</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-least-squares-4-6-1-1">
<div class="para">If the columns of <span class="process-math">\(A\)</span> are linearly independent, then there is a unique least-squares approximate solution <span class="process-math">\(\xhat\)</span> to the equation <span class="process-math">\(A\xvec=\bvec\)</span> given by the normal equation</div>
<div class="displaymath process-math">
\begin{equation*}
A^TA\xhat = A^T\bvec\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-6-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Proposition 6.5.6"><a href="#sec-least-squares-4-6" title="Copy heading and permalink for Proposition 6.5.6" aria-label="Copy heading and permalink for Proposition 6.5.6">🔗</a></div></article><article class="example example-like" id="sec-least-squares-4-7"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">6.5.7</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-least-squares-4-7-1">
<div class="para">Consider the equation</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{bmatrix}
2 \amp 1 \\
2 \amp 0 \\
-1 \amp 3 \\
\end{bmatrix}
\xvec
= \threevec{16}{-1}7
\end{equation*}
</div>
<div class="para">with matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\text{.}\)</span> Since this equation is inconsistent, we will find the least-squares approximate solution <span class="process-math">\(\xhat\)</span> by solving the normal equation <span class="process-math">\(A^TA\xhat = A^T\bvec\text{,}\)</span> which has the form</div>
<div class="displaymath process-math">
\begin{equation*}
A^TA\xhat = \begin{bmatrix} 9 \amp -1 \\ -1 \amp 10 \\
\end{bmatrix} \xhat = \twovec{23}{37} = A^T\bvec 
\end{equation*}
</div>
<div class="para">and the solution <span class="process-math">\(\xhat=\twovec34\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-7-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Example 6.5.7"><a href="#sec-least-squares-4-7" title="Copy heading and permalink for Example 6.5.7" aria-label="Copy heading and permalink for Example 6.5.7">🔗</a></div></article><article class="activity project-like" id="sec-least-squares-4-8"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.5.3</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-least-squares-4-8-1-1">
<div class="para">The rate at which a cricket chirps is related to the outdoor temperature, as reflected in some experimental data that we’ll study in this activity.  The chirp rate <span class="process-math">\(C\)</span> is expressed in chirps per second while the temperature <span class="process-math">\(T\)</span> is in degrees Fahrenheit.  Evaluate the following cell to load the data: <div id="sec-least-squares-4-8-1-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/crickets.csv')
data = [vector(row) for row in df.values]
chirps = vector(df['Chirps'])
temps = vector(df['Temperature'])
print(df)
list_plot(data, color='blue', size=40, xmin=12, xmax=22, ymin=60, ymax=100)
</script></div> Evaluating this cell also provides:</div>
<ul class="disc" id="sec-least-squares-4-8-1-1-4">
<li id="sec-least-squares-4-8-1-1-4-1">
<div class="para" id="sec-least-squares-4-8-1-1-4-1-1">the vectors <code class="code-inline tex2jax_ignore">chirps</code> and <code class="code-inline tex2jax_ignore">temps</code> formed from the columns of the dataset.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-1-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-4-8-1-1-4-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-4-8-1-1-4-2">
<div class="para" id="sec-least-squares-4-8-1-1-4-2-1">the command <code class="code-inline tex2jax_ignore">onesvec(n)</code>, which creates an <span class="process-math">\(n\)</span>-dimensional vector whose entries are all one.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-1-4-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-4-8-1-1-4-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-4-8-1-1-4-3">
<div class="para" id="sec-least-squares-4-8-1-1-4-3-1">Remember that you can form a matrix whose columns are the vectors <code class="code-inline tex2jax_ignore">v1</code> and <code class="code-inline tex2jax_ignore">v2</code> with <code class="code-inline tex2jax_ignore">matrix([v1, v2]).T</code>.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-1-4-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-4-8-1-1-4-3" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="sec-least-squares-4-8-1-2">
<div class="para">We would like to represent this relationship by a linear function</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1 C = T\text{.}
\end{equation*}
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-4-8-1-2-2">
<li id="sec-least-squares-4-8-1-2-2-1">
<div class="para" id="sec-least-squares-4-8-1-2-2-1-1">Use the first data point <span class="process-math">\((C_1,T_1)=(20.0,88.6)\)</span> to write an equation involving <span class="process-math">\(\beta_0\)</span> and <span class="process-math">\(\beta_1\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item a"><a href="#sec-least-squares-4-8-1-2-2-1" title="Copy heading and permalink for Item a" aria-label="Copy heading and permalink for Item a">🔗</a></div>
</li>
<li id="sec-least-squares-4-8-1-2-2-2">
<div class="para" id="sec-least-squares-4-8-1-2-2-2-1">Suppose that we represent the unknowns using a vector <span class="process-math">\(\xvec = \twovec{\beta_0}{\beta_1}\text{.}\)</span>  Use the 15 data points to create the matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\)</span> so that the linear system <span class="process-math">\(A\xvec= \bvec\)</span> describes the unknown vector <span class="process-math">\(\xvec\text{.}\)</span> <div id="sec-least-squares-4-8-1-2-2-2-1-6" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item b"><a href="#sec-least-squares-4-8-1-2-2-2" title="Copy heading and permalink for Item b" aria-label="Copy heading and permalink for Item b">🔗</a></div>
</li>
<li id="sec-least-squares-4-8-1-2-2-3">
<div class="para" id="sec-least-squares-4-8-1-2-2-3-1">Write the normal equations <span class="process-math">\(A^TA\xhat =
A^T\bvec\text{;}\)</span> that is, find the matrix <span class="process-math">\(A^TA\)</span> and the vector <span class="process-math">\(A^T\bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c"><a href="#sec-least-squares-4-8-1-2-2-3" title="Copy heading and permalink for Item c" aria-label="Copy heading and permalink for Item c">🔗</a></div>
</li>
<li id="sec-least-squares-4-8-1-2-2-4">
<div class="para" id="sec-least-squares-4-8-1-2-2-4-1">Solve the normal equations to find <span class="process-math">\(\xhat\text{,}\)</span> the least-squares approximate solution to the equation <span class="process-math">\(A\xvec=\bvec\text{.}\)</span>  Call your solution <code class="code-inline tex2jax_ignore">xhat</code> since <code class="code-inline tex2jax_ignore">x</code> has another meaning in Sage. <div id="sec-least-squares-4-8-1-2-2-4-1-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-4-8-1-2-2-4-2">What are the values of <span class="process-math">\(\beta_0\)</span> and <span class="process-math">\(\beta_1\)</span> that you found?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item d"><a href="#sec-least-squares-4-8-1-2-2-4" title="Copy heading and permalink for Item d" aria-label="Copy heading and permalink for Item d">🔗</a></div>
</li>
<li id="sec-least-squares-4-8-1-2-2-5">
<div class="para" id="sec-least-squares-4-8-1-2-2-5-1">If the chirp rate is 22 chirps per second, what is your prediction for the temperature?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-4-8-1-2-2-5-2">You can plot the data and your line, assuming you called the solution <code class="code-inline tex2jax_ignore">xhat</code>, using the cell below. <div id="sec-least-squares-4-8-1-2-2-5-2-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">plot_model(xhat, data, domain=(12, 22))
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2-2-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item e"><a href="#sec-least-squares-4-8-1-2-2-5" title="Copy heading and permalink for Item e" aria-label="Copy heading and permalink for Item e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-8-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Activity 6.5.3"><a href="#sec-least-squares-4-8" title="Copy heading and permalink for Activity 6.5.3" aria-label="Copy heading and permalink for Activity 6.5.3">🔗</a></div></article><div class="para" id="sec-least-squares-4-9">This example demonstrates an approach, called <em class="emphasis">linear regression</em>, in which a collection of data is modeled using a linear function found by solving a least-squares problem. Once we have the linear function that best fits the data, we can make predictions about situations that we haven’t encountered in the data.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-4-10">If we’re going to use our function to make predictions, it’s natural to ask how much confidence we have in these predictions.  This is a statistical question that leads to a rich and well-developed theory<details class="ptx-footnote" aria-live="polite" id="sec-least-squares-4-10-1"><summary class="ptx-footnote__number" title="Footnote 6.5.1"><sup> 1 </sup></summary><div class="ptx-footnote__contents" id="sec-least-squares-4-10-1">For example, see Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani. <em class="emphasis">An Introduction to Statistical Learning: with Applications in R.</em> Springer, 2013.</div></details>, which we won’t explore in much detail here.  However, there is one simple measure of how well our linear function fits the data that is known as the coefficient of determination and denoted by <span class="process-math">\(R^2\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-10" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-4-11">We have seen that the square of the distance <span class="process-math">\(\len{\bvec-A\xvec}^2\)</span> measures the amount by which the line fails to pass through the data points.  When the line is close to the data points, we expect this number to be small.  However, the size of this measure depends on the scale of the data.  For instance, the two lines shown in <a href="sec-least-squares.html#fig-regression-scale" class="xref" data-knowl="./knowl/xref/fig-regression-scale.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 6.5.8">Figure 6.5.8</a> seem to fit the data equally well, but <span class="process-math">\(|\bvec-A\xhat|^2\)</span> is 100 times larger on the right.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-11" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="fig-regression-scale"><div class="sidebyside"><div class="sbsrow" style="margin-left:2.5%;margin-right:2.5%;">
<div class="sbspanel top" style="width:47.3684210526316%;"><img src="external/images/line-regress-1.svg" role="img" class="contained"></div>
<div class="sbspanel top" style="width:47.3684210526316%;"><img src="external/images/line-regress-10.svg" role="img" class="contained"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">6.5.8<span class="period">.</span></span><span class="space"> </span>The lines appear to fit equally well in spite of the fact that <span class="process-math">\(\len{\bvec-A\xhat}^2\)</span> differs by a factor of 100.<div class="autopermalink" data-description="Figure 6.5.8"><a href="#fig-regression-scale" title="Copy heading and permalink for Figure 6.5.8" aria-label="Copy heading and permalink for Figure 6.5.8">🔗</a></div></figcaption></figure><div class="para" id="sec-least-squares-4-13">The coefficient of determination <span class="process-math">\(R^2\)</span> is defined by normalizing <span class="process-math">\(|\bvec-A\xhat|^2\)</span> so that it is independent of the scale.  Recall that we described how to demean a vector in <a href="sec-dot-product.html" class="internal" title="Section 6.1: The dot product">Section 6.1</a>:  given a vector <span class="process-math">\(\vvec\text{,}\)</span> we obtain <span class="process-math">\(\widetilde{\vvec}\)</span> by subtracting the average of the components from each component.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-13" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="definition definition-like" id="sec-least-squares-4-14"><h4 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">6.5.9</span><span class="period">.</span><span class="space"> </span><span class="title">Coefficient of determination.</span>
</h4>
<div class="para logical" id="sec-least-squares-4-14-4-1">
<div class="para">The coefficient of determination is</div>
<div class="displaymath process-math">
\begin{equation*}
R^2 = 1 - \frac{|\bvec - A\xhat|^2}
{|\widetilde{\bvec}|^2},
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(\widetilde{\bvec}\)</span> is the vector obtained by demeaning <span class="process-math">\(\bvec\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-14-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Definition 6.5.9: Coefficient of determination"><a href="#sec-least-squares-4-14" title="Copy heading and permalink for Definition 6.5.9: Coefficient of determination" aria-label="Copy heading and permalink for Definition 6.5.9: Coefficient of determination">🔗</a></div></article><div class="para" id="sec-least-squares-4-15">A more complete explanation of this definition relies on the concept of variance, which we explore in <a href="sec-least-squares.html#ex-r2-meaning" class="xref" data-knowl="./knowl/xref/ex-r2-meaning.html" data-reveal-label="Reveal" data-close-label="Close" title="Exercise 6.5.6.12">Exercise 6.5.6.12</a> and the next chapter.  For the time being, it’s enough to know that <span class="process-math">\(0\leq R^2 \leq 1\)</span> and that the closer <span class="process-math">\(R^2\)</span> is to 1, the better the line fits the data. In our original example, illustrated in <a href="sec-least-squares.html#fig-regression-scale" class="xref" data-knowl="./knowl/xref/fig-regression-scale.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 6.5.8">Figure 6.5.8</a>, we find that <span class="process-math">\(R^2 = 0.75\text{,}\)</span> and in our study of cricket chirp rates, we have <span class="process-math">\(R^2=0.69\text{.}\)</span>  However, assessing the confidence we have in predictions made by solving a least-squares problem can require considerable thought, and it would be naive to rely only on the value of <span class="process-math">\(R^2\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-4-15" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 6.5.2: Solving least-squares problems"><a href="#sec-least-squares-4" title="Copy heading and permalink for Subsection 6.5.2: Solving least-squares problems" aria-label="Copy heading and permalink for Subsection 6.5.2: Solving least-squares problems">🔗</a></div></section><section class="subsection" id="sec-least-squares-5"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.5.3</span><span class="space"> </span><span class="title">Using <span class="process-math">\(QR\)</span> factorizations</span>
</h3>
<div class="para" id="sec-least-squares-5-2">As we’ve seen, the least-squares approximate solution <span class="process-math">\(\xhat\)</span> to <span class="process-math">\(A\xvec=\bvec\)</span> may be found by solving the normal equation <span class="process-math">\(A^TA\xhat = A^T\bvec\text{,}\)</span> and this can be a practical strategy for some problems.  However, this approach can be problematic as small rounding errors can accumulate and lead to inaccurate final results.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-5-3">As the next activity demonstrates, there is an alternate method for finding the least-squares approximate solution <span class="process-math">\(\xhat\)</span> using a <span class="process-math">\(QR\)</span> factorization of the matrix <span class="process-math">\(A\text{,}\)</span> and this method is preferable as it is numerically more reliable.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-5-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="activity project-like" id="activity-BFI"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.5.4</span><span class="period">.</span>
</h4>
<div class="para logical" id="activity-BFI-1-1">
<ol class="lower-alpha ol-marker-1" id="activity-BFI-1-1-1">
<li id="activity-BFI-1-1-1-1">
<div class="para logical" id="activity-BFI-1-1-1-1-1">
<div class="para">Suppose we are interested in finding the least-squares approximate solution to the equation <span class="process-math">\(A\xvec =
\bvec\)</span> and that we have the <span class="process-math">\(QR\)</span> factorization <span class="process-math">\(A=QR\text{.}\)</span>  Explain why the least-squares approximate solution is given by solving</div>
<div class="displaymath process-math" id="activity-BFI-1-1-1-1-1-4">
\begin{align*}
A\xhat \amp = QQ^T\bvec \\\\
QR\xhat \amp = QQ^T\bvec \\
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item a"><a href="#activity-BFI-1-1-1-1" title="Copy heading and permalink for Item a" aria-label="Copy heading and permalink for Item a">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-2">
<div class="para logical" id="activity-BFI-1-1-1-2-1">
<div class="para">Multiply both sides of the second expression by <span class="process-math">\(Q^T\)</span> and explain why</div>
<div class="displaymath process-math">
\begin{equation*}
R\xhat = Q^T\bvec.
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="activity-BFI-1-1-1-2-2">
<div class="para">Since <span class="process-math">\(R\)</span> is upper triangular, this is a relatively simple equation to solve using back substitution, as we saw in <a href="sec-gaussian-revisited.html" class="internal" title="Section 5.1: Gaussian elimination revisited">Section 5.1</a>.  We will therefore write the least-squares approximate solution as</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/sec-gaussian-revisited.html">
\begin{equation*}
\xhat = R^{-1}Q^T\bvec,
\end{equation*}
</div>
<div class="para">and put this to use in the following context.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item b"><a href="#activity-BFI-1-1-1-2" title="Copy heading and permalink for Item b" aria-label="Copy heading and permalink for Item b">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-3">
<div class="para logical" id="activity-BFI-1-1-1-3-1">
<div class="para">Brozak’s formula, which is used to calculate a person’s body fat index <span class="process-math">\(BFI\text{,}\)</span> is</div>
<div class="displaymath process-math">
\begin{equation*}
BFI = 100 \left(\frac{4.57}{\rho} - 4.142\right)
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(\rho\)</span> denotes a person’s body density in grams per cubic centimeter.  Obtaining an accurate measure of <span class="process-math">\(\rho\)</span> is difficult, however, because it requires submerging the person in water and measuring the volume of water displaced.  Instead, we will gather several other body measurements, which are more easily obtained, and use it to predict <span class="process-math">\(BFI\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="activity-BFI-1-1-1-3-2">
<div class="para">For instance, suppose we take 10 patients and measure their weight <span class="process-math">\(w\)</span> in pounds, height <span class="process-math">\(h\)</span> in inches, abdomen <span class="process-math">\(a\)</span> in centimeters, wrist circumference <span class="process-math">\(r\)</span> in centimeters, neck circumference <span class="process-math">\(n\)</span> in centimeters, and <span class="process-math">\(BFI\text{.}\)</span>  Evaluating the following cell loads and displays the data. <div id="activity-BFI-1-1-1-3-2-7" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/bfi.csv')
weight = vector(df['Weight'])
height = vector(df['Height'])
abdomen = vector(df['Abdomen'])
wrist = vector(df['Wrist'])
neck = vector(df['Neck'])
BFI = vector(df['BFI'])
print(df)
</script></div> In addition, that cell provides:</div>
<ol class="lower-alpha lower-alpha-level-1" id="activity-BFI-1-1-1-3-2-8">
<li id="activity-BFI-1-1-1-3-2-8-1">
<div class="para" id="activity-BFI-1-1-1-3-2-8-1-1">vectors <code class="code-inline tex2jax_ignore">weight</code>, <code class="code-inline tex2jax_ignore">height</code>, <code class="code-inline tex2jax_ignore">abdomen</code>, <code class="code-inline tex2jax_ignore">wrist</code>, <code class="code-inline tex2jax_ignore">neck</code>, and <code class="code-inline tex2jax_ignore">BFI</code> formed from the columns of the dataset.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c.a"><a href="#activity-BFI-1-1-1-3-2-8-1" title="Copy heading and permalink for Item c.a" aria-label="Copy heading and permalink for Item c.a">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-3-2-8-2">
<div class="para" id="activity-BFI-1-1-1-3-2-8-2-1">the command <code class="code-inline tex2jax_ignore">onesvec(n)</code>, which returns an <span class="process-math">\(n\)</span>-dimensional vector whose entries are all one.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c.b"><a href="#activity-BFI-1-1-1-3-2-8-2" title="Copy heading and permalink for Item c.b" aria-label="Copy heading and permalink for Item c.b">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-3-2-8-3">
<div class="para" id="activity-BFI-1-1-1-3-2-8-3-1">the command <code class="code-inline tex2jax_ignore">QR(A)</code> that returns the <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\)</span> as <code class="code-inline tex2jax_ignore">Q, R = QR(A)</code>.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c.c"><a href="#activity-BFI-1-1-1-3-2-8-3" title="Copy heading and permalink for Item c.c" aria-label="Copy heading and permalink for Item c.c">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-3-2-8-4">
<div class="para" id="activity-BFI-1-1-1-3-2-8-4-1">the command <code class="code-inline tex2jax_ignore">demean(v)</code>, which returns the demeaned vector <span class="process-math">\(\widetilde{\vvec}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2-8-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c.d"><a href="#activity-BFI-1-1-1-3-2-8-4" title="Copy heading and permalink for Item c.d" aria-label="Copy heading and permalink for Item c.d">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="activity-BFI-1-1-1-3-3">
<div class="para">We would like to find the linear function</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1w + \beta_2h + \beta_3a + \beta_4r +
\beta_5n = BFI
\end{equation*}
</div>
<div class="para">that best fits the data.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="activity-BFI-1-1-1-3-4">Use the first data point to write an equation for the parameters <span class="process-math">\(\beta_0,\beta_1,\ldots,\beta_5\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-3-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c"><a href="#activity-BFI-1-1-1-3" title="Copy heading and permalink for Item c" aria-label="Copy heading and permalink for Item c">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-4">
<div class="para" id="activity-BFI-1-1-1-4-1">Describe the linear system <span class="process-math">\(A\xvec = \bvec\)</span> for these parameters.  More specifically, describe how the matrix <span class="process-math">\(A\)</span> and the vector <span class="process-math">\(\bvec\)</span> are formed.<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item d"><a href="#activity-BFI-1-1-1-4" title="Copy heading and permalink for Item d" aria-label="Copy heading and permalink for Item d">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-5">
<div class="para" id="activity-BFI-1-1-1-5-1">Construct the matrix <span class="process-math">\(A\)</span> and find its <span class="process-math">\(QR\)</span> factorization in the cell below. <div id="activity-BFI-1-1-1-5-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item e"><a href="#activity-BFI-1-1-1-5" title="Copy heading and permalink for Item e" aria-label="Copy heading and permalink for Item e">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-6">
<div class="para" id="activity-BFI-1-1-1-6-1">Find the least-squares approximate solution <span class="process-math">\(\xhat\)</span> by solving the equation <span class="process-math">\(R\xhat =
Q^T\bvec\text{.}\)</span>  You may want to use <code class="code-inline tex2jax_ignore">N(xhat)</code> to display a decimal approximation of the vector. What are the parameters <span class="process-math">\(\beta_0,\beta_1,\ldots,\beta_5\)</span> that best fit the data?<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-6-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item f"><a href="#activity-BFI-1-1-1-6" title="Copy heading and permalink for Item f" aria-label="Copy heading and permalink for Item f">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-7">
<div class="para" id="activity-BFI-1-1-1-7-1">Find the coefficient of determination <span class="process-math">\(R^2\)</span> for your parameters.  What does this imply about the quality of the fit? <div id="activity-BFI-1-1-1-7-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-7-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item g"><a href="#activity-BFI-1-1-1-7" title="Copy heading and permalink for Item g" aria-label="Copy heading and permalink for Item g">🔗</a></div>
</li>
<li id="activity-BFI-1-1-1-8">
<div class="para" id="activity-BFI-1-1-1-8-1">Suppose a person’s measurements are: weight 190, height 70, abdomen 90, wrist 18, and neck 35.  Estimate this person’s <span class="process-math">\(BFI\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1-1-8-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item h"><a href="#activity-BFI-1-1-1-8" title="Copy heading and permalink for Item h" aria-label="Copy heading and permalink for Item h">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#activity-BFI-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Activity 6.5.4"><a href="#activity-BFI" title="Copy heading and permalink for Activity 6.5.4" aria-label="Copy heading and permalink for Activity 6.5.4">🔗</a></div></article><div class="para" id="sec-least-squares-5-5">To summarize, we have seen that<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-5-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="proposition theorem-like" id="sec-least-squares-5-6"><h4 class="heading">
<span class="type">Proposition</span><span class="space"> </span><span class="codenumber">6.5.10</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-least-squares-5-6-1-1">
<div class="para">If the columns of <span class="process-math">\(A\)</span> are linearly independent and we have the <span class="process-math">\(QR\)</span> factorization <span class="process-math">\(A=QR\text{,}\)</span> then the least-squares approximate solution <span class="process-math">\(\xhat\)</span> to the equation <span class="process-math">\(A\xvec=\bvec\)</span> is given by</div>
<div class="displaymath process-math">
\begin{equation*}
\xhat = R^{-1}Q^T\bvec\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-5-6-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Proposition 6.5.10"><a href="#sec-least-squares-5-6" title="Copy heading and permalink for Proposition 6.5.10" aria-label="Copy heading and permalink for Proposition 6.5.10">🔗</a></div></article><div class="autopermalink" data-description="Subsection 6.5.3: Using QR factorizations"><a href="#sec-least-squares-5" title="Copy heading and permalink for Subsection 6.5.3: Using QR factorizations" aria-label="Copy heading and permalink for Subsection 6.5.3: Using QR factorizations">🔗</a></div></section><section class="subsection" id="sec-least-squares-6"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.5.4</span><span class="space"> </span><span class="title">Polynomial Regression</span>
</h3>
<div class="para" id="sec-least-squares-6-2">In the examples we’ve seen so far, we have fit a linear function to a dataset.  Sometimes, however, a polynomial, such as a quadratic function, may be more appropriate.  It turns out that the techniques we’ve developed in this section are still useful as the next activity demonstrates.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="activity project-like" id="sec-least-squares-6-3"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.5.5</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-least-squares-6-3-1-1">
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-6-3-1-1-1">
<li id="sec-least-squares-6-3-1-1-1-1">
<div class="para logical" id="sec-least-squares-6-3-1-1-1-1-1">
<div class="para">Suppose that we have a small dataset containing the points <span class="process-math">\((0,2)\text{,}\)</span> <span class="process-math">\((1,1)\text{,}\)</span> <span class="process-math">\((2,3)\text{,}\)</span> and <span class="process-math">\((3,3)\text{,}\)</span> such as appear when the following cell is evaluated. <div id="sec-least-squares-6-3-1-1-1-1-1-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py',
globals())
data = [[0, 2], [1, 1], [2, 3], [3, 3]]
list_plot(data, color='blue', size=40)
</script></div> In addition to loading and plotting the data, evaluating that cell provides the following commands:</div>
<ul class="disc" id="sec-least-squares-6-3-1-1-1-1-1-6">
<li id="sec-least-squares-6-3-1-1-1-1-1-6-1">
<div class="para" id="sec-least-squares-6-3-1-1-1-1-1-6-1-1">
<code class="code-inline tex2jax_ignore">Q, R = QR(A)</code> returns the <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-1-1-6-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-6-3-1-1-1-1-1-6-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-1-1-6-2">
<div class="para" id="sec-least-squares-6-3-1-1-1-1-1-6-2-1">
<code class="code-inline tex2jax_ignore">demean(v)</code> returns the demeaned vector <span class="process-math">\(\widetilde{\vvec}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-1-1-6-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-6-3-1-1-1-1-1-6-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-least-squares-6-3-1-1-1-1-2">
<div class="para">Let’s fit a quadratic function of the form</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1 x + \beta_2 x^2 = y
\end{equation*}
</div>
<div class="para">to this dataset.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-6-3-1-1-1-1-3">Write four equations, one for each data point, that describe the coefficients <span class="process-math">\(\beta_0\text{,}\)</span> <span class="process-math">\(\beta_1\text{,}\)</span> and <span class="process-math">\(\beta_2\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-1-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item a"><a href="#sec-least-squares-6-3-1-1-1-1" title="Copy heading and permalink for Item a" aria-label="Copy heading and permalink for Item a">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-2">
<div class="para" id="sec-least-squares-6-3-1-1-1-2-1">Express these four equations as a linear system <span class="process-math">\(A\xvec = \bvec\)</span> where <span class="process-math">\(\xvec =
\threevec{\beta_0}{\beta_1}{\beta_2}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-6-3-1-1-1-2-2">Find the <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\)</span> and use it to find the least-squares approximate solution <span class="process-math">\(\xhat\text{.}\)</span> <div id="sec-least-squares-6-3-1-1-1-2-2-4" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item b"><a href="#sec-least-squares-6-3-1-1-1-2" title="Copy heading and permalink for Item b" aria-label="Copy heading and permalink for Item b">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-3">
<div class="para" id="sec-least-squares-6-3-1-1-1-3-1">Use the parameters <span class="process-math">\(\beta_0\text{,}\)</span> <span class="process-math">\(\beta_1\text{,}\)</span> and <span class="process-math">\(\beta_2\)</span> that you found to write the quadratic function that fits the data.  You can plot this function, along with the data, by entering your function in the place indicated below. <div id="sec-least-squares-6-3-1-1-1-3-1-4" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">list_plot(data, color='blue', size=40) + plot( **your function here**,
0, 3, color='red')
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c"><a href="#sec-least-squares-6-3-1-1-1-3" title="Copy heading and permalink for Item c" aria-label="Copy heading and permalink for Item c">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-4">
<div class="para" id="sec-least-squares-6-3-1-1-1-4-1">What is your predicted <span class="process-math">\(y\)</span> value when <span class="process-math">\(x=1.5\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item d"><a href="#sec-least-squares-6-3-1-1-1-4" title="Copy heading and permalink for Item d" aria-label="Copy heading and permalink for Item d">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-5">
<div class="para" id="sec-least-squares-6-3-1-1-1-5-1">Find the coefficient of determination <span class="process-math">\(R^2\)</span> for the quadratic function.  What does this say about the quality of the fit?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item e"><a href="#sec-least-squares-6-3-1-1-1-5" title="Copy heading and permalink for Item e" aria-label="Copy heading and permalink for Item e">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-6">
<div class="para logical" id="sec-least-squares-6-3-1-1-1-6-1">
<div class="para">Now fit a cubic polynomial of the form</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1x + \beta_2 x^2 + \beta_3x^3 = y
\end{equation*}
</div>
<div class="para">to this dataset. <div id="sec-least-squares-6-3-1-1-1-6-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-6-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item f"><a href="#sec-least-squares-6-3-1-1-1-6" title="Copy heading and permalink for Item f" aria-label="Copy heading and permalink for Item f">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-7">
<div class="para" id="sec-least-squares-6-3-1-1-1-7-1">Find the coefficient of determination <span class="process-math">\(R^2\)</span> for the cubic function.  What does this say about the quality of the fit?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-7-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item g"><a href="#sec-least-squares-6-3-1-1-1-7" title="Copy heading and permalink for Item g" aria-label="Copy heading and permalink for Item g">🔗</a></div>
</li>
<li id="sec-least-squares-6-3-1-1-1-8">
<div class="para" id="sec-least-squares-6-3-1-1-1-8-1">What do you notice when you plot the cubic function along with the data?  How does this reflect the value of <span class="process-math">\(R^2\)</span> that you found? <div id="sec-least-squares-6-3-1-1-1-8-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">list_plot(data, color='blue', size=40) + plot( **your function here**,
0, 3, color='red')
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1-1-8-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item h"><a href="#sec-least-squares-6-3-1-1-1-8" title="Copy heading and permalink for Item h" aria-label="Copy heading and permalink for Item h">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-3-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Activity 6.5.5"><a href="#sec-least-squares-6-3" title="Copy heading and permalink for Activity 6.5.5" aria-label="Copy heading and permalink for Activity 6.5.5">🔗</a></div></article><div class="para logical" id="sec-least-squares-6-4">
<div class="para">The matrices <span class="process-math">\(A\)</span> that you created in the last activity when fitting a quadratic and cubic function to a dataset have a special form.  In particular, if the data points are labeled <span class="process-math">\((x_i, y_i)\)</span> and we seek a degree <span class="process-math">\(k\)</span> polynomial, then</div>
<div class="displaymath process-math">
\begin{equation*}
A =
\begin{bmatrix}
1 \amp x_1 \amp x_1^2 \amp \ldots \amp x_1^k \\
1 \amp x_2 \amp x_2^2 \amp \ldots \amp x_2^k \\
\vdots \amp \vdots \amp \vdots \amp \ddots \amp \vdots \\
1 \amp x_m \amp x_m^2 \amp \ldots \amp x_m^k \\
\end{bmatrix}.
\end{equation*}
</div>
<div class="para">This is called a <em class="emphasis">Vandermonde</em> matrix of degree <span class="process-math">\(k\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="activity project-like" id="sec-least-squares-6-5"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.5.6</span><span class="period">.</span>
</h4>
<div class="para" id="sec-least-squares-6-5-1-1">This activity explores a dataset describing Arctic sea ice and that comes from <a class="external" href="http://sustainabilitymath.org/" target="_blank">Sustainability Math.</a><details class="ptx-footnote" aria-live="polite" id="sec-least-squares-6-5-1-1-2"><summary class="ptx-footnote__number" title="Footnote 6.5.2"><sup> 2 </sup></summary><div class="ptx-footnote__contents" id="sec-least-squares-6-5-1-1-2"><code class="code-inline tex2jax_ignore">sustainabilitymath.org</code></div></details><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="sec-least-squares-6-5-1-2">
<div class="para">Evaluating the cell below will plot the extent of Arctic sea ice, in millions of square kilometers, during the twelve months of 2012. <div id="sec-least-squares-6-5-1-2-1" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/sea_ice.csv')
data = [vector([row[0], row[2]]) for row in df.values]
month = vector(df['Month'])
ice = vector(df['2012'])
print(df[['Month', '2012']])
list_plot(data, color='blue', size=40)
</script></div> In addition, you have access to a few special variables and commands:</div>
<ul class="disc" id="sec-least-squares-6-5-1-2-2">
<li id="sec-least-squares-6-5-1-2-2-1">
<div class="para" id="sec-least-squares-6-5-1-2-2-1-1">
<code class="code-inline tex2jax_ignore">month</code> is the vector of month values and <code class="code-inline tex2jax_ignore">ice</code> is the vector of sea ice values from the table above.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-2-2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-6-5-1-2-2-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-2-2-2">
<div class="para" id="sec-least-squares-6-5-1-2-2-2-1">
<code class="code-inline tex2jax_ignore">vandermonde(x, k)</code> constructs the Vandermonde matrix of degree <span class="process-math">\(k\)</span> using the points in the vector <code class="code-inline tex2jax_ignore">x</code>.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-2-2-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-6-5-1-2-2-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-2-2-3">
<div class="para" id="sec-least-squares-6-5-1-2-2-3-1">
<code class="code-inline tex2jax_ignore">Q, R = QR(A)</code> provides the <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-2-2-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-6-5-1-2-2-3" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-2-2-4">
<div class="para" id="sec-least-squares-6-5-1-2-2-4-1">
<code class="code-inline tex2jax_ignore">demean(v)</code> returns the demeaned vector <span class="process-math">\(\widetilde{\vvec}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-2-2-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-6-5-1-2-2-4" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="sec-least-squares-6-5-1-3">
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-6-5-1-3-1">
<li id="sec-least-squares-6-5-1-3-1-1">
<div class="para" id="sec-least-squares-6-5-1-3-1-1-1">Find the vector <span class="process-math">\(\xhat\text{,}\)</span> the least-squares approximate solution to the linear system that results from fitting a degree 5 polynomial to the data. <div id="sec-least-squares-6-5-1-3-1-1-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item a"><a href="#sec-least-squares-6-5-1-3-1-1" title="Copy heading and permalink for Item a" aria-label="Copy heading and permalink for Item a">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-3-1-2">
<div class="para" id="sec-least-squares-6-5-1-3-1-2-1">If your result is stored in the variable <code class="code-inline tex2jax_ignore">xhat</code>, you may plot the polynomial and the data together using the following cell. <div id="sec-least-squares-6-5-1-3-1-2-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">plot_model(xhat, data)
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item b"><a href="#sec-least-squares-6-5-1-3-1-2" title="Copy heading and permalink for Item b" aria-label="Copy heading and permalink for Item b">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-3-1-3">
<div class="para" id="sec-least-squares-6-5-1-3-1-3-1">Find the coefficient of determination <span class="process-math">\(R^2\)</span> for this polynomial fit.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item c"><a href="#sec-least-squares-6-5-1-3-1-3" title="Copy heading and permalink for Item c" aria-label="Copy heading and permalink for Item c">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-3-1-4">
<div class="para" id="sec-least-squares-6-5-1-3-1-4-1">Repeat these steps to fit a degree 8 polynomial to the data, plot the polynomial with the data, and find <span class="process-math">\(R^2\text{.}\)</span> <div id="sec-least-squares-6-5-1-3-1-4-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item d"><a href="#sec-least-squares-6-5-1-3-1-4" title="Copy heading and permalink for Item d" aria-label="Copy heading and permalink for Item d">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-3-1-5">
<div class="para" id="sec-least-squares-6-5-1-3-1-5-1">Repeat one more time by fitting a degree 11 polynomial to the data, creating a plot, and finding <span class="process-math">\(R^2\text{.}\)</span> <div id="sec-least-squares-6-5-1-3-1-5-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-6-5-1-3-1-5-2">It’s certainly true that higher degree polynomials fit the data better, as seen by the increasing values of <span class="process-math">\(R^2\text{,}\)</span> but that’s not always a good thing. For instance, when <span class="process-math">\(k=11\text{,}\)</span> you may notice that the graph of the polynomial wiggles a little more than we would expect. In this case, the polynomial is trying too hard to fit the data, which usually contains some uncertainty, especially if it’s obtained from measurements.  The error built in to the data is called <em class="emphasis">noise,</em> and its presence means that we shouldn’t expect our polynomial to fit the data perfectly.  When we choose a polynomial whose degree is too high, we give the noise too much weight in the model, which leads to some undesirable behavior, like the wiggles in the graph.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-least-squares-6-5-1-3-1-5-3">Fitting the data with a polynomial whose degree is too high is called <em class="emphasis">overfitting</em>, a phenomenon that can appear in many machine learning applications. Generally speaking, we would like to choose <span class="process-math">\(k\)</span> large enough to capture the essential features of the data but not so large that we overfit and build the noise into the model.  There are ways to determine the optimal value of <span class="process-math">\(k\text{,}\)</span> but we won’t pursue that here.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-5-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item e"><a href="#sec-least-squares-6-5-1-3-1-5" title="Copy heading and permalink for Item e" aria-label="Copy heading and permalink for Item e">🔗</a></div>
</li>
<li id="sec-least-squares-6-5-1-3-1-6">
<div class="para" id="sec-least-squares-6-5-1-3-1-6-1">Choosing a reasonable value of <span class="process-math">\(k\text{,}\)</span> estimate the extent of Arctic sea ice at month 6.5, roughly at the Summer Solstice.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3-1-6-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item f"><a href="#sec-least-squares-6-5-1-3-1-6" title="Copy heading and permalink for Item f" aria-label="Copy heading and permalink for Item f">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-6-5-1-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Activity 6.5.6"><a href="#sec-least-squares-6-5" title="Copy heading and permalink for Activity 6.5.6" aria-label="Copy heading and permalink for Activity 6.5.6">🔗</a></div></article><div class="autopermalink" data-description="Subsection 6.5.4: Polynomial Regression"><a href="#sec-least-squares-6" title="Copy heading and permalink for Subsection 6.5.4: Polynomial Regression" aria-label="Copy heading and permalink for Subsection 6.5.4: Polynomial Regression">🔗</a></div></section><section class="subsection" id="sec-least-squares-7"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">6.5.5</span><span class="space"> </span><span class="title">Summary</span>
</h3>
<div class="para logical" id="sec-least-squares-7-2">
<div class="para">This section introduced some types of least-squares problems and a framework for working with them.</div>
<ul class="disc" id="sec-least-squares-7-2-1">
<li id="sec-least-squares-7-2-1-1">
<div class="para" id="sec-least-squares-7-2-1-1-1">Given an inconsistent system <span class="process-math">\(A\xvec=\bvec\text{,}\)</span> we find <span class="process-math">\(\xhat\text{,}\)</span> the least-squares approximate solution, by requiring that <span class="process-math">\(A\xhat\)</span> be as close to <span class="process-math">\(\bvec\)</span> as possible.  In other words, <span class="process-math">\(A\xhat = \bhat\)</span> where <span class="process-math">\(\bhat\)</span> is the orthogonal projection of <span class="process-math">\(\bvec\)</span> onto <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-7-2-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-7-2-1-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-7-2-1-2">
<div class="para" id="sec-least-squares-7-2-1-2-1">One way to find <span class="process-math">\(\xhat\)</span> is by solving the normal equations <span class="process-math">\(A^TA\xhat = A^T\bvec.\)</span>  This is not our preferred method since numerical problems can arise.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-7-2-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-7-2-1-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-7-2-1-3">
<div class="para" id="sec-least-squares-7-2-1-3-1">A second way to find <span class="process-math">\(\xhat\)</span> uses a <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\text{.}\)</span>  If <span class="process-math">\(A=QR\text{,}\)</span> then <span class="process-math">\(\xhat
= R^{-1}Q^T\bvec\)</span> and finding <span class="process-math">\(R^{-1}\)</span> is computationally feasible since <span class="process-math">\(R\)</span> is upper triangular.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-7-2-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-7-2-1-3" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-7-2-1-4">
<div class="para" id="sec-least-squares-7-2-1-4-1">This technique may be applied widely and is useful for modeling data.  We saw examples in this section where linear functions of several input variables and polynomials provided effective models for different datasets.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-7-2-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-7-2-1-4" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-7-2-1-5">
<div class="para" id="sec-least-squares-7-2-1-5-1">A simple measure of the quality of the fit is the coefficient of determination <span class="process-math">\(R^2\)</span> though some additional thought should be given in real applications.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-7-2-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-7-2-1-5" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-7-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 6.5.5: Summary"><a href="#sec-least-squares-7" title="Copy heading and permalink for Subsection 6.5.5: Summary" aria-label="Copy heading and permalink for Subsection 6.5.5: Summary">🔗</a></div></section><section class="exercises" id="sec-least-squares-8"><h3 class="heading hide-type">
<span class="type">Exercises</span><span class="space"> </span><span class="codenumber">6.5.6</span><span class="space"> </span><span class="title">Exercises</span>
</h3>
<div class="para logical" id="sec-least-squares-8-1">
<div class="para">Evaluating the following cell loads in some commands that will be helpful in the following exercises.  In particular, there are commands:</div>
<ul class="disc" id="sec-least-squares-8-1-1">
<li id="sec-least-squares-8-1-1-1">
<div class="para" id="sec-least-squares-8-1-1-1-1">
<code class="code-inline tex2jax_ignore">QR(A)</code> that returns the <span class="process-math">\(QR\)</span> factorization of <code class="code-inline tex2jax_ignore">A</code> as <code class="code-inline tex2jax_ignore">Q, R = QR(A)</code>,<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-1-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-8-1-1-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-8-1-1-2">
<div class="para" id="sec-least-squares-8-1-1-2-1">
<code class="code-inline tex2jax_ignore">onesvec(n)</code> that returns the <span class="process-math">\(n\)</span>-dimensional vector whose entries are all 1,<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-1-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-8-1-1-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-8-1-1-3">
<div class="para" id="sec-least-squares-8-1-1-3-1">
<code class="code-inline tex2jax_ignore">demean(v)</code> that demeans the vector <code class="code-inline tex2jax_ignore">v</code>,<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-1-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-8-1-1-3" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-8-1-1-4">
<div class="para" id="sec-least-squares-8-1-1-4-1">
<code class="code-inline tex2jax_ignore">vandermonde(x, k)</code> that returns the Vandermonde matrix of degree <span class="process-math">\(k\)</span> formed from the components of the vector <code class="code-inline tex2jax_ignore">x</code>, and<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-1-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-8-1-1-4" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-least-squares-8-1-1-5">
<div class="para" id="sec-least-squares-8-1-1-5-1">
<code class="code-inline tex2jax_ignore">plot_model(xhat, data)</code> that plots the <code class="code-inline tex2jax_ignore">data</code> and the model <code class="code-inline tex2jax_ignore">xhat</code>.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-1-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-least-squares-8-1-1-5" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="para"><div id="sec-least-squares-8-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
</script></div></div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="exercise exercise-like" id="sec-least-squares-8-2"><h4 class="heading"><span class="codenumber">1<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-2-1-1">
<div class="para">Suppose we write the linear system</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{bmatrix}
1 \amp -1 \\
2 \amp -1 \\
-1 \amp 3 
\end{bmatrix}
\xvec = \threevec{-8}5{-10}
\end{equation*}
</div>
<div class="para">as <span class="process-math">\(A\xvec=\bvec\text{.}\)</span>
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-2-1-1-3">
<li id="sec-least-squares-8-2-1-1-3-1">
<div class="para" id="sec-least-squares-8-2-1-1-3-1-1">Find an orthogonal basis for <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-2-1-1-3-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.1.a"><a href="#sec-least-squares-8-2-1-1-3-1" title="Copy heading and permalink for Item 6.5.6.1.a" aria-label="Copy heading and permalink for Item 6.5.6.1.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-2-1-1-3-2">
<div class="para" id="sec-least-squares-8-2-1-1-3-2-1">Find <span class="process-math">\(\bhat\text{,}\)</span> the orthogonal projection of <span class="process-math">\(\bvec\)</span> onto <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-2-1-1-3-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.1.b"><a href="#sec-least-squares-8-2-1-1-3-2" title="Copy heading and permalink for Item 6.5.6.1.b" aria-label="Copy heading and permalink for Item 6.5.6.1.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-2-1-1-3-3">
<div class="para" id="sec-least-squares-8-2-1-1-3-3-1">Find a solution to the linear system <span class="process-math">\(A\xvec =
\bhat\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-2-1-1-3-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.1.c"><a href="#sec-least-squares-8-2-1-1-3-3" title="Copy heading and permalink for Item 6.5.6.1.c" aria-label="Copy heading and permalink for Item 6.5.6.1.c">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.1"><a href="#sec-least-squares-8-2" title="Copy heading and permalink for Exercise 6.5.6.1" aria-label="Copy heading and permalink for Exercise 6.5.6.1">🔗</a></div></article><article class="exercise exercise-like" id="ex-lst-squares-line"><h4 class="heading"><span class="codenumber">2<span class="period">.</span></span></h4>
<div class="para logical" id="ex-lst-squares-line-1-1">
<div class="para">Consider the data in <a href="sec-least-squares.html#table-lst-squares-line" class="xref" data-knowl="./knowl/xref/table-lst-squares-line.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 6.5.11: A dataset with four points.">Table 6.5.11</a>. <figure class="table table-like" id="table-lst-squares-line"><figcaption><span class="type">Table</span><span class="space"> </span><span class="codenumber">6.5.11<span class="period">.</span></span><span class="space"> </span>A dataset with four points.<div class="autopermalink" data-description="Table 6.5.11: A dataset with four points."><a href="#table-lst-squares-line" title="Copy heading and permalink for Table 6.5.11: A dataset with four points." aria-label="Copy heading and permalink for Table 6.5.11: A dataset with four points.">🔗</a></div></figcaption><div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="c m b1 r0 l0 t0 lines"><span class="process-math">\(x\)</span></td>
<td class="c m b1 r0 l0 t0 lines"><span class="process-math">\(y\)</span></td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">1</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">1</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">3</td>
<td class="c m b0 r0 l0 t0 lines">1</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">4</td>
<td class="c m b0 r0 l0 t0 lines">2</td>
</tr>
</table></div></figure> <div id="ex-lst-squares-line-1-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
</div>
<ol class="lower-alpha ol-marker-1" id="ex-lst-squares-line-1-1-4">
<li id="ex-lst-squares-line-1-1-4-1">
<div class="para" id="ex-lst-squares-line-1-1-4-1-1">Set up the linear system <span class="process-math">\(A\xvec=\bvec\)</span> that describes the line <span class="process-math">\(b + mx = y\)</span> passing through these points.<div class="autopermalink" data-description="Paragraph"><a href="#ex-lst-squares-line-1-1-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.2.a"><a href="#ex-lst-squares-line-1-1-4-1" title="Copy heading and permalink for Item 6.5.6.2.a" aria-label="Copy heading and permalink for Item 6.5.6.2.a">🔗</a></div>
</li>
<li id="ex-lst-squares-line-1-1-4-2">
<div class="para" id="ex-lst-squares-line-1-1-4-2-1">Write the normal equations that describe the least-squares approximate solution to <span class="process-math">\(A\xvec=\bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-lst-squares-line-1-1-4-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.2.b"><a href="#ex-lst-squares-line-1-1-4-2" title="Copy heading and permalink for Item 6.5.6.2.b" aria-label="Copy heading and permalink for Item 6.5.6.2.b">🔗</a></div>
</li>
<li id="ex-lst-squares-line-1-1-4-3">
<div class="para" id="ex-lst-squares-line-1-1-4-3-1">Find the least-squares approximate solution <span class="process-math">\(\xhat\)</span> and plot the data and the resulting line.<div class="autopermalink" data-description="Paragraph"><a href="#ex-lst-squares-line-1-1-4-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.2.c"><a href="#ex-lst-squares-line-1-1-4-3" title="Copy heading and permalink for Item 6.5.6.2.c" aria-label="Copy heading and permalink for Item 6.5.6.2.c">🔗</a></div>
</li>
<li id="ex-lst-squares-line-1-1-4-4">
<div class="para" id="ex-lst-squares-line-1-1-4-4-1">What is your predicted <span class="process-math">\(y\)</span>-value when <span class="process-math">\(x=3.5\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-lst-squares-line-1-1-4-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.2.d"><a href="#ex-lst-squares-line-1-1-4-4" title="Copy heading and permalink for Item 6.5.6.2.d" aria-label="Copy heading and permalink for Item 6.5.6.2.d">🔗</a></div>
</li>
<li id="ex-lst-squares-line-1-1-4-5">
<div class="para" id="ex-lst-squares-line-1-1-4-5-1">Find the coefficient of determination <span class="process-math">\(R^2\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-lst-squares-line-1-1-4-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.2.e"><a href="#ex-lst-squares-line-1-1-4-5" title="Copy heading and permalink for Item 6.5.6.2.e" aria-label="Copy heading and permalink for Item 6.5.6.2.e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#ex-lst-squares-line-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.2"><a href="#ex-lst-squares-line" title="Copy heading and permalink for Exercise 6.5.6.2" aria-label="Copy heading and permalink for Exercise 6.5.6.2">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-4"><h4 class="heading"><span class="codenumber">3<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-4-1-1">
<div class="para">Consider the four points in <a href="sec-least-squares.html#table-lst-squares-line" class="xref" data-knowl="./knowl/xref/table-lst-squares-line.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 6.5.11: A dataset with four points.">Table 6.5.11</a>. <div id="sec-least-squares-8-4-1-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-4-1-1-3">
<li id="sec-least-squares-8-4-1-1-3-1">
<div class="para logical" id="sec-least-squares-8-4-1-1-3-1-1">
<div class="para">Set up a linear system <span class="process-math">\(A\xvec = \bvec\)</span> that describes a quadratic function</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0+\beta_1x+\beta_2x^2 = y
\end{equation*}
</div>
<div class="para">passing through the points.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-4-1-1-3-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.3.a"><a href="#sec-least-squares-8-4-1-1-3-1" title="Copy heading and permalink for Item 6.5.6.3.a" aria-label="Copy heading and permalink for Item 6.5.6.3.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-4-1-1-3-2">
<div class="para" id="sec-least-squares-8-4-1-1-3-2-1">Use a <span class="process-math">\(QR\)</span> factorization to find the least-squares approximate solution <span class="process-math">\(\xhat\)</span> and plot the data and the graph of the resulting quadratic function.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-4-1-1-3-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.3.b"><a href="#sec-least-squares-8-4-1-1-3-2" title="Copy heading and permalink for Item 6.5.6.3.b" aria-label="Copy heading and permalink for Item 6.5.6.3.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-4-1-1-3-3">
<div class="para" id="sec-least-squares-8-4-1-1-3-3-1">What is your predicted <span class="process-math">\(y\)</span>-value when <span class="process-math">\(x=3.5\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-4-1-1-3-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.3.c"><a href="#sec-least-squares-8-4-1-1-3-3" title="Copy heading and permalink for Item 6.5.6.3.c" aria-label="Copy heading and permalink for Item 6.5.6.3.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-4-1-1-3-4">
<div class="para" id="sec-least-squares-8-4-1-1-3-4-1">Find the coefficient of determination <span class="process-math">\(R^2\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-4-1-1-3-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.3.d"><a href="#sec-least-squares-8-4-1-1-3-4" title="Copy heading and permalink for Item 6.5.6.3.d" aria-label="Copy heading and permalink for Item 6.5.6.3.d">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.3"><a href="#sec-least-squares-8-4" title="Copy heading and permalink for Exercise 6.5.6.3" aria-label="Copy heading and permalink for Exercise 6.5.6.3">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-5"><h4 class="heading"><span class="codenumber">4<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-5-1-1">
<div class="para">Consider the data in <a href="sec-least-squares.html#table-lst-squares-multi" class="xref" data-knowl="./knowl/xref/table-lst-squares-multi.html" data-reveal-label="Reveal" data-close-label="Close" title="Table 6.5.12: A simple dataset">Table 6.5.12</a>. <figure class="table table-like" id="table-lst-squares-multi"><figcaption><span class="type">Table</span><span class="space"> </span><span class="codenumber">6.5.12<span class="period">.</span></span><span class="space"> </span>A simple dataset<div class="autopermalink" data-description="Table 6.5.12: A simple dataset"><a href="#table-lst-squares-multi" title="Copy heading and permalink for Table 6.5.12: A simple dataset" aria-label="Copy heading and permalink for Table 6.5.12: A simple dataset">🔗</a></div></figcaption><div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="c m b1 r0 l0 t0 lines"><span class="process-math">\(x_1\)</span></td>
<td class="c m b1 r0 l0 t0 lines"><span class="process-math">\(x_2\)</span></td>
<td class="c m b1 r0 l0 t0 lines"><span class="process-math">\(y\)</span></td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">4.2</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">3.3</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">1</td>
<td class="c m b0 r0 l0 t0 lines">5.9</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">5.1</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">3</td>
<td class="c m b0 r0 l0 t0 lines">2</td>
<td class="c m b0 r0 l0 t0 lines">7.5</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">3</td>
<td class="c m b0 r0 l0 t0 lines">3</td>
<td class="c m b0 r0 l0 t0 lines">6.3</td>
</tr>
</table></div></figure> <div id="sec-least-squares-8-5-1-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">
</script></div>
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-5-1-1-4">
<li id="sec-least-squares-8-5-1-1-4-1">
<div class="para logical" id="sec-least-squares-8-5-1-1-4-1-1">
<div class="para">Set up a linear system <span class="process-math">\(A\xvec = \bvec\)</span> that describes the relationship</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1 x_1 + \beta_2 x_2 = y.
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-5-1-1-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.4.a"><a href="#sec-least-squares-8-5-1-1-4-1" title="Copy heading and permalink for Item 6.5.6.4.a" aria-label="Copy heading and permalink for Item 6.5.6.4.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-5-1-1-4-2">
<div class="para" id="sec-least-squares-8-5-1-1-4-2-1">Find the least-squares approximate solution <span class="process-math">\(\xhat\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-5-1-1-4-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.4.b"><a href="#sec-least-squares-8-5-1-1-4-2" title="Copy heading and permalink for Item 6.5.6.4.b" aria-label="Copy heading and permalink for Item 6.5.6.4.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-5-1-1-4-3">
<div class="para" id="sec-least-squares-8-5-1-1-4-3-1">What is your predicted <span class="process-math">\(y\)</span>-value when <span class="process-math">\(x_1 =
2.4\)</span> and <span class="process-math">\(x_2=2.9\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-5-1-1-4-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.4.c"><a href="#sec-least-squares-8-5-1-1-4-3" title="Copy heading and permalink for Item 6.5.6.4.c" aria-label="Copy heading and permalink for Item 6.5.6.4.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-5-1-1-4-4">
<div class="para" id="sec-least-squares-8-5-1-1-4-4-1">Find the coefficient of determination <span class="process-math">\(R^2\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-5-1-1-4-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.4.d"><a href="#sec-least-squares-8-5-1-1-4-4" title="Copy heading and permalink for Item 6.5.6.4.d" aria-label="Copy heading and permalink for Item 6.5.6.4.d">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-5-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.4"><a href="#sec-least-squares-8-5" title="Copy heading and permalink for Exercise 6.5.6.4" aria-label="Copy heading and permalink for Exercise 6.5.6.4">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-6"><h4 class="heading"><span class="codenumber">5<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-6-1-1">
<div class="para">Determine whether the following statements are true or false and explain your thinking.</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-6-1-1-1">
<li id="sec-least-squares-8-6-1-1-1-1">
<div class="para" id="sec-least-squares-8-6-1-1-1-1-1">If <span class="process-math">\(A\xvec=\bvec\)</span> is consistent, then <span class="process-math">\(\xhat\)</span> is a solution to <span class="process-math">\(A\xvec=\bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-6-1-1-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.5.a"><a href="#sec-least-squares-8-6-1-1-1-1" title="Copy heading and permalink for Item 6.5.6.5.a" aria-label="Copy heading and permalink for Item 6.5.6.5.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-6-1-1-1-2">
<div class="para" id="sec-least-squares-8-6-1-1-1-2-1">If <span class="process-math">\(R^2=1\text{,}\)</span> then the least-squares approximate solution <span class="process-math">\(\xhat\)</span> is also a solution to the original equation <span class="process-math">\(A\xvec=\bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-6-1-1-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.5.b"><a href="#sec-least-squares-8-6-1-1-1-2" title="Copy heading and permalink for Item 6.5.6.5.b" aria-label="Copy heading and permalink for Item 6.5.6.5.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-6-1-1-1-3">
<div class="para" id="sec-least-squares-8-6-1-1-1-3-1">Given the <span class="process-math">\(QR\)</span> factorization <span class="process-math">\(A=QR\text{,}\)</span> we have <span class="process-math">\(A\xhat=Q^TQ\bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-6-1-1-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.5.c"><a href="#sec-least-squares-8-6-1-1-1-3" title="Copy heading and permalink for Item 6.5.6.5.c" aria-label="Copy heading and permalink for Item 6.5.6.5.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-6-1-1-1-4">
<div class="para" id="sec-least-squares-8-6-1-1-1-4-1">A <span class="process-math">\(QR\)</span> factorization provides a method for finding the least-squares approximate solution to <span class="process-math">\(A\xvec=\bvec\)</span> that is more reliable than solving the normal equations.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-6-1-1-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.5.d"><a href="#sec-least-squares-8-6-1-1-1-4" title="Copy heading and permalink for Item 6.5.6.5.d" aria-label="Copy heading and permalink for Item 6.5.6.5.d">🔗</a></div>
</li>
<li id="sec-least-squares-8-6-1-1-1-5">
<div class="para" id="sec-least-squares-8-6-1-1-1-5-1">A solution to <span class="process-math">\(AA^T\xvec = A\bvec\)</span> is the least-squares approximate solution to <span class="process-math">\(A\xvec = \bvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-6-1-1-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.5.e"><a href="#sec-least-squares-8-6-1-1-1-5" title="Copy heading and permalink for Item 6.5.6.5.e" aria-label="Copy heading and permalink for Item 6.5.6.5.e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-6-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.5"><a href="#sec-least-squares-8-6" title="Copy heading and permalink for Exercise 6.5.6.5" aria-label="Copy heading and permalink for Exercise 6.5.6.5">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-7"><h4 class="heading"><span class="codenumber">6<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-7-1-1">
<div class="para">Explain your response to the following questions.</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-7-1-1-1">
<li id="sec-least-squares-8-7-1-1-1-1">
<div class="para" id="sec-least-squares-8-7-1-1-1-1-1">If <span class="process-math">\(\xhat=\zerovec\text{,}\)</span> what does this say about the vector <span class="process-math">\(\bvec\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-7-1-1-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.6.a"><a href="#sec-least-squares-8-7-1-1-1-1" title="Copy heading and permalink for Item 6.5.6.6.a" aria-label="Copy heading and permalink for Item 6.5.6.6.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-7-1-1-1-2">
<div class="para" id="sec-least-squares-8-7-1-1-1-2-1">If the columns of <span class="process-math">\(A\)</span> are orthonormal, how can you easily find the least-squares approximate solution to <span class="process-math">\(A\xvec=\bvec\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-7-1-1-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.6.b"><a href="#sec-least-squares-8-7-1-1-1-2" title="Copy heading and permalink for Item 6.5.6.6.b" aria-label="Copy heading and permalink for Item 6.5.6.6.b">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-7-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.6"><a href="#sec-least-squares-8-7" title="Copy heading and permalink for Exercise 6.5.6.6" aria-label="Copy heading and permalink for Exercise 6.5.6.6">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-8"><h4 class="heading"><span class="codenumber">7<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-8-1-1">
<div class="para">The following cell loads in some data showing the number of people in Bangladesh living without electricity over 27 years. It also defines vectors <code class="code-inline tex2jax_ignore">year</code>, which records the years in the dataset, and <code class="code-inline tex2jax_ignore">people</code>, which records the number of people. <div id="sec-least-squares-8-8-1-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/bangladesh.csv')
data = [vector(row) for row in df.values]
year = vector(df['Year'])
people = vector(df['People'])
print(df)
list_plot(data, size=40, color='blue')
</script></div>
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-8-1-1-4">
<li id="sec-least-squares-8-8-1-1-4-1">
<div class="para logical" id="sec-least-squares-8-8-1-1-4-1-1">
<div class="para">Suppose we want to write</div>
<div class="displaymath process-math">
\begin{equation*}
N = \beta_0 + \beta_1 t
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(t\)</span> is the year and <span class="process-math">\(N\)</span> is the number of people. Construct the matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\)</span> so that the linear system <span class="process-math">\(A\xvec=\bvec\)</span> describes the vector <span class="process-math">\(\xvec=\twovec{\beta_0}{\beta_1}\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-8-1-1-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.7.a"><a href="#sec-least-squares-8-8-1-1-4-1" title="Copy heading and permalink for Item 6.5.6.7.a" aria-label="Copy heading and permalink for Item 6.5.6.7.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-8-1-1-4-2">
<div class="para" id="sec-least-squares-8-8-1-1-4-2-1">Using a <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(A\text{,}\)</span> find the values of <span class="process-math">\(\beta_0\)</span> and <span class="process-math">\(\beta_1\)</span> in the least-squares approximate solution <span class="process-math">\(\xhat\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-8-1-1-4-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.7.b"><a href="#sec-least-squares-8-8-1-1-4-2" title="Copy heading and permalink for Item 6.5.6.7.b" aria-label="Copy heading and permalink for Item 6.5.6.7.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-8-1-1-4-3">
<div class="para" id="sec-least-squares-8-8-1-1-4-3-1">What is the coefficient of determination <span class="process-math">\(R^2\)</span> and what does this tell us about the quality of the approximation?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-8-1-1-4-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.7.c"><a href="#sec-least-squares-8-8-1-1-4-3" title="Copy heading and permalink for Item 6.5.6.7.c" aria-label="Copy heading and permalink for Item 6.5.6.7.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-8-1-1-4-4">
<div class="para" id="sec-least-squares-8-8-1-1-4-4-1">What is your prediction for the number of people living without electricity in 1985?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-8-1-1-4-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.7.d"><a href="#sec-least-squares-8-8-1-1-4-4" title="Copy heading and permalink for Item 6.5.6.7.d" aria-label="Copy heading and permalink for Item 6.5.6.7.d">🔗</a></div>
</li>
<li id="sec-least-squares-8-8-1-1-4-5">
<div class="para" id="sec-least-squares-8-8-1-1-4-5-1">Estimate the year in which there will be no people living without electricity.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-8-1-1-4-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.7.e"><a href="#sec-least-squares-8-8-1-1-4-5" title="Copy heading and permalink for Item 6.5.6.7.e" aria-label="Copy heading and permalink for Item 6.5.6.7.e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-8-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.7"><a href="#sec-least-squares-8-8" title="Copy heading and permalink for Exercise 6.5.6.7" aria-label="Copy heading and permalink for Exercise 6.5.6.7">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-9"><h4 class="heading"><span class="codenumber">8<span class="period">.</span></span></h4>
<div class="para" id="sec-least-squares-8-9-1-1">This problem concerns a dataset describing planets in our Solar system. For each planet, we have the length <span class="process-math">\(L\)</span> of the semi-major axis, essentially the distance from the planet to the Sun in AU (astronomical units), and the period <span class="process-math">\(P\text{,}\)</span> the length of time in years required to complete one orbit around the Sun.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="sec-least-squares-8-9-1-2">
<div class="para">We would like to model this data using the function <span class="process-math">\(P = CL^r\)</span> where <span class="process-math">\(C\)</span> and <span class="process-math">\(r\)</span> are parameters we need to determine.  Since this isn’t a linear function, we will transform this relationship by taking the natural logarithm of both sides to obtain</div>
<div class="displaymath process-math">
\begin{equation*}
\ln(P) = \ln(C) + r\ln(L).
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="sec-least-squares-8-9-1-3">
<div class="para">Evaluating the following cell loads the dataset and defines two vectors <code class="code-inline tex2jax_ignore">logaxis</code>, whose components are <span class="process-math">\(\ln(L)\text{,}\)</span> and <code class="code-inline tex2jax_ignore">logperiod</code>, whose components are <span class="process-math">\(\ln(P)\text{.}\)</span> <div id="sec-least-squares-8-9-1-3-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">import numpy as np	    
sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/planets.csv',index_col=0)
logaxis = vector(np.log(df['Semi-major axis']))
logperiod = vector(np.log(df['Period']))
print(df)
</script></div>
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-9-1-3-6">
<li id="sec-least-squares-8-9-1-3-6-1">
<div class="para" id="sec-least-squares-8-9-1-3-6-1-1">Construct the matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\)</span> so that the solution to <span class="process-math">\(A\xvec=\bvec\)</span> is the vector <span class="process-math">\(\xvec=\ctwovec{\ln(C)}r\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-3-6-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.8.a"><a href="#sec-least-squares-8-9-1-3-6-1" title="Copy heading and permalink for Item 6.5.6.8.a" aria-label="Copy heading and permalink for Item 6.5.6.8.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-9-1-3-6-2">
<div class="para" id="sec-least-squares-8-9-1-3-6-2-1">Find the least-squares approximate solution <span class="process-math">\(\xhat\text{.}\)</span>  What does this give for the values of <span class="process-math">\(C\)</span> and <span class="process-math">\(r\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-3-6-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.8.b"><a href="#sec-least-squares-8-9-1-3-6-2" title="Copy heading and permalink for Item 6.5.6.8.b" aria-label="Copy heading and permalink for Item 6.5.6.8.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-9-1-3-6-3">
<div class="para" id="sec-least-squares-8-9-1-3-6-3-1">Find the coefficient of determination <span class="process-math">\(R^2\text{.}\)</span>  What does this tell us about the quality of the approximation?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-3-6-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.8.c"><a href="#sec-least-squares-8-9-1-3-6-3" title="Copy heading and permalink for Item 6.5.6.8.c" aria-label="Copy heading and permalink for Item 6.5.6.8.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-9-1-3-6-4">
<div class="para" id="p-derived-sec-least-squares-8-9-1-3-6-4">Suppose that the orbit of an asteroid has a semi-major axis whose length is <span class="process-math">\(L=4.0\)</span> AU.  Estimate the period <span class="process-math">\(P\)</span> of the asteroid’s orbit.</div>
<div class="autopermalink" data-description="Item 6.5.6.8.d"><a href="#sec-least-squares-8-9-1-3-6-4" title="Copy heading and permalink for Item 6.5.6.8.d" aria-label="Copy heading and permalink for Item 6.5.6.8.d">🔗</a></div>
</li>
<li id="sec-least-squares-8-9-1-3-6-5">
<div class="para" id="sec-least-squares-8-9-1-3-6-5-1">Halley’s Comet has a period of <span class="process-math">\(P=75\)</span> years. Estimate the length of its semi-major axis.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-3-6-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.8.e"><a href="#sec-least-squares-8-9-1-3-6-5" title="Copy heading and permalink for Item 6.5.6.8.e" aria-label="Copy heading and permalink for Item 6.5.6.8.e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-9-1-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.8"><a href="#sec-least-squares-8-9" title="Copy heading and permalink for Exercise 6.5.6.8" aria-label="Copy heading and permalink for Exercise 6.5.6.8">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-10"><h4 class="heading"><span class="codenumber">9<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-10-1-1">
<div class="para">Evaluating the following cell loads a dataset describing the temperature in the Earth’s atmosphere at various altitudes. There are also two vectors <code class="code-inline tex2jax_ignore">altitude</code>, expressed in kilometers, and <code class="code-inline tex2jax_ignore">temperature</code>, in degrees Celsius. <div id="sec-least-squares-8-10-1-1-3" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/altitude-temps.csv')
data = [vector(row) for row in df.values]
altitude = vector(df['Altitude'])
temperature = vector(df['Temperature'])
print(df)
list_plot(data, size=40, color='blue')
</script></div>
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-10-1-1-4">
<li id="sec-least-squares-8-10-1-1-4-1">
<div class="para" id="sec-least-squares-8-10-1-1-4-1-1">Describe how to form the matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\)</span> so that the linear system <span class="process-math">\(A\xvec=\bvec\)</span> describes a degree <span class="process-math">\(k\)</span> polynomial fitting the data.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-10-1-1-4-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.9.a"><a href="#sec-least-squares-8-10-1-1-4-1" title="Copy heading and permalink for Item 6.5.6.9.a" aria-label="Copy heading and permalink for Item 6.5.6.9.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-10-1-1-4-2">
<div class="para" id="sec-least-squares-8-10-1-1-4-2-1">After choosing a value of <span class="process-math">\(k\text{,}\)</span> construct the matrix <span class="process-math">\(A\)</span> and vector <span class="process-math">\(\bvec\text{,}\)</span> and find the least-squares approximate solution <span class="process-math">\(\xhat\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-10-1-1-4-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.9.b"><a href="#sec-least-squares-8-10-1-1-4-2" title="Copy heading and permalink for Item 6.5.6.9.b" aria-label="Copy heading and permalink for Item 6.5.6.9.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-10-1-1-4-3">
<div class="para" id="sec-least-squares-8-10-1-1-4-3-1">Plot the polynomial and data using <code class="code-inline tex2jax_ignore">plot_model(xhat, data)</code>.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-10-1-1-4-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.9.c"><a href="#sec-least-squares-8-10-1-1-4-3" title="Copy heading and permalink for Item 6.5.6.9.c" aria-label="Copy heading and permalink for Item 6.5.6.9.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-10-1-1-4-4">
<div class="para" id="sec-least-squares-8-10-1-1-4-4-1">Now examine what happens as you vary the degree of the polynomial <span class="process-math">\(k\text{.}\)</span>  Choose an appropriate value of <span class="process-math">\(k\)</span> that seems to capture the most important features of the data while avoiding overfitting, and explain your choice.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-10-1-1-4-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.9.d"><a href="#sec-least-squares-8-10-1-1-4-4" title="Copy heading and permalink for Item 6.5.6.9.d" aria-label="Copy heading and permalink for Item 6.5.6.9.d">🔗</a></div>
</li>
<li id="sec-least-squares-8-10-1-1-4-5">
<div class="para" id="sec-least-squares-8-10-1-1-4-5-1">Use your value of <span class="process-math">\(k\)</span> to estimate the temperature at an altitude of 55 kilometers.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-10-1-1-4-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.9.e"><a href="#sec-least-squares-8-10-1-1-4-5" title="Copy heading and permalink for Item 6.5.6.9.e" aria-label="Copy heading and permalink for Item 6.5.6.9.e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-10-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.9"><a href="#sec-least-squares-8-10" title="Copy heading and permalink for Exercise 6.5.6.9" aria-label="Copy heading and permalink for Exercise 6.5.6.9">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-11"><h4 class="heading"><span class="codenumber">10<span class="period">.</span></span></h4>
<div class="para logical" id="sec-least-squares-8-11-1-1">
<div class="para">The following cell loads some data describing 1057 houses in a particular real estate market.  For each house, we record the living area in square feet, the lot size in acres, the age in years, and the price in dollars.  The cell also defines variables <code class="code-inline tex2jax_ignore">area</code>, <code class="code-inline tex2jax_ignore">size</code>, <code class="code-inline tex2jax_ignore">age</code>, and <code class="code-inline tex2jax_ignore">price</code>. <div id="sec-least-squares-8-11-1-1-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">sage.repl.load.load('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/orthogonality.py', globals())
df = pd.read_csv('https://raw.githubusercontent.com/davidaustinm/ula_modules/master/data/housing.csv',index_col=0)
df = df.fillna(df.mean())
area = vector(df['Living.Area'])
size = vector(df['Lot.Size'])
age = vector(df['Age'])
price = vector(df['Price'])
df
</script></div> We will use linear regression to predict the price of a house given its living area, lot size, and age:</div>
<div class="displaymath process-math">
\begin{equation*}
\beta_0 + \beta_1~\text{Living Area} +
\beta_2~\text{Lot Size} + \beta_3~\text{Age} = \text{Price}.
\end{equation*}
</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-11-1-1-7">
<li id="sec-least-squares-8-11-1-1-7-1">
<div class="para" id="sec-least-squares-8-11-1-1-7-1-1">Use a <span class="process-math">\(QR\)</span> factorization to find the least-squares approximate solution <span class="process-math">\(\xhat\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-11-1-1-7-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.10.a"><a href="#sec-least-squares-8-11-1-1-7-1" title="Copy heading and permalink for Item 6.5.6.10.a" aria-label="Copy heading and permalink for Item 6.5.6.10.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-11-1-1-7-2">
<div class="para" id="sec-least-squares-8-11-1-1-7-2-1">Discuss the significance of the signs of <span class="process-math">\(\beta_1\text{,}\)</span> <span class="process-math">\(\beta_2\text{,}\)</span> and <span class="process-math">\(\beta_3\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-11-1-1-7-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.10.b"><a href="#sec-least-squares-8-11-1-1-7-2" title="Copy heading and permalink for Item 6.5.6.10.b" aria-label="Copy heading and permalink for Item 6.5.6.10.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-11-1-1-7-3">
<div class="para" id="sec-least-squares-8-11-1-1-7-3-1">If two houses are identical except for differing in age by one year, how would you predict that their prices compare to each another?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-11-1-1-7-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.10.c"><a href="#sec-least-squares-8-11-1-1-7-3" title="Copy heading and permalink for Item 6.5.6.10.c" aria-label="Copy heading and permalink for Item 6.5.6.10.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-11-1-1-7-4">
<div class="para" id="sec-least-squares-8-11-1-1-7-4-1">Find the coefficient of determination <span class="process-math">\(R^2\text{.}\)</span>  What does this say about the quality of the fit?<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-11-1-1-7-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.10.d"><a href="#sec-least-squares-8-11-1-1-7-4" title="Copy heading and permalink for Item 6.5.6.10.d" aria-label="Copy heading and permalink for Item 6.5.6.10.d">🔗</a></div>
</li>
<li id="sec-least-squares-8-11-1-1-7-5">
<div class="para" id="sec-least-squares-8-11-1-1-7-5-1">Predict the price of a house whose living area is 2000 square feet, lot size is 1.5 acres, and age is 50 years.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-11-1-1-7-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.10.e"><a href="#sec-least-squares-8-11-1-1-7-5" title="Copy heading and permalink for Item 6.5.6.10.e" aria-label="Copy heading and permalink for Item 6.5.6.10.e">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-11-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.10"><a href="#sec-least-squares-8-11" title="Copy heading and permalink for Exercise 6.5.6.10" aria-label="Copy heading and permalink for Exercise 6.5.6.10">🔗</a></div></article><article class="exercise exercise-like" id="sec-least-squares-8-12"><h4 class="heading"><span class="codenumber">11<span class="period">.</span></span></h4>
<div class="para" id="sec-least-squares-8-12-1-1">We observed that if the columns of <span class="process-math">\(A\)</span> are linearly independent, then there is a unique least-squares approximate solution to the equation <span class="process-math">\(A\xvec=\bvec\)</span> because the equation <span class="process-math">\(A\xhat=\bhat\)</span> has a unique solution.  We also said that <span class="process-math">\(\xhat\)</span> is the unique solution to the normal equation <span class="process-math">\(A^TA\xhat = A^T\bvec\)</span> without explaining why this equation has a unique solution.  This exercise offers an explanation.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-12-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="sec-least-squares-8-12-1-2">
<div class="para">Assuming that the columns of <span class="process-math">\(A\)</span> are linearly independent, we would like to conclude that the equation <span class="process-math">\(A^TA\xhat=A^T\bvec\)</span> has a unique solution.</div>
<ol class="lower-alpha ol-marker-1" id="sec-least-squares-8-12-1-2-3">
<li id="sec-least-squares-8-12-1-2-3-1">
<div class="para logical" id="sec-least-squares-8-12-1-2-3-1-1">
<div class="para">Suppose that <span class="process-math">\(\xvec\)</span> is a vector for which <span class="process-math">\(A^TA\xvec = \zerovec\text{.}\)</span>  Explain why the following argument is valid and allows us to conclude that <span class="process-math">\(A\xvec = \zerovec\text{.}\)</span>
</div>
<div class="displaymath process-math">
\begin{equation*}
\begin{aligned}
A^TA\xvec \amp = \zerovec \\
\xvec\cdot A^TA\xvec \amp = \xvec\cdot\zerovec = 0 \\
(A\xvec)\cdot(A\xvec) \amp = 0 \\
\len{A\xvec}^2 \amp = 0. \\
\end{aligned}
\end{equation*}
</div>
<div class="para">In other words, if <span class="process-math">\(A^TA\xvec = \zerovec\text{,}\)</span> we know that <span class="process-math">\(A\xvec = \zerovec\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-12-1-2-3-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.11.a"><a href="#sec-least-squares-8-12-1-2-3-1" title="Copy heading and permalink for Item 6.5.6.11.a" aria-label="Copy heading and permalink for Item 6.5.6.11.a">🔗</a></div>
</li>
<li id="sec-least-squares-8-12-1-2-3-2">
<div class="para" id="sec-least-squares-8-12-1-2-3-2-1">If the columns of <span class="process-math">\(A\)</span> are linearly independent and <span class="process-math">\(A\xvec = \zerovec\text{,}\)</span> what do we know about the vector <span class="process-math">\(\xvec\text{?}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-12-1-2-3-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.11.b"><a href="#sec-least-squares-8-12-1-2-3-2" title="Copy heading and permalink for Item 6.5.6.11.b" aria-label="Copy heading and permalink for Item 6.5.6.11.b">🔗</a></div>
</li>
<li id="sec-least-squares-8-12-1-2-3-3">
<div class="para" id="sec-least-squares-8-12-1-2-3-3-1">Explain why <span class="process-math">\(A^TA\xvec = \zerovec\)</span> can only happen when <span class="process-math">\(\xvec = \zerovec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-12-1-2-3-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.11.c"><a href="#sec-least-squares-8-12-1-2-3-3" title="Copy heading and permalink for Item 6.5.6.11.c" aria-label="Copy heading and permalink for Item 6.5.6.11.c">🔗</a></div>
</li>
<li id="sec-least-squares-8-12-1-2-3-4">
<div class="para" id="sec-least-squares-8-12-1-2-3-4-1">Assuming that the columns of <span class="process-math">\(A\)</span> are linearly independent, explain why <span class="process-math">\(A^TA\xhat=A^T\bvec\)</span> has a unique solution.<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-12-1-2-3-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.11.d"><a href="#sec-least-squares-8-12-1-2-3-4" title="Copy heading and permalink for Item 6.5.6.11.d" aria-label="Copy heading and permalink for Item 6.5.6.11.d">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-least-squares-8-12-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.11"><a href="#sec-least-squares-8-12" title="Copy heading and permalink for Exercise 6.5.6.11" aria-label="Copy heading and permalink for Exercise 6.5.6.11">🔗</a></div></article><article class="exercise exercise-like" id="ex-r2-meaning"><h4 class="heading"><span class="codenumber">12<span class="period">.</span></span></h4>
<div class="para" id="ex-r2-meaning-1-1">This problem is about the meaning of the coefficient of determination <span class="process-math">\(R^2\)</span> and its connection to variance, a topic that appears in the next section.  Throughout this problem, we consider the linear system <span class="process-math">\(A\xvec=\bvec\)</span> and the approximate least-squares solution <span class="process-math">\(\xhat\text{,}\)</span> where <span class="process-math">\(A\xhat=\bhat\text{.}\)</span>  We suppose that <span class="process-math">\(A\)</span> is an <span class="process-math">\(m\times n\)</span> matrix, and we will denote the <span class="process-math">\(m\)</span>-dimensional vector <span class="process-math">\(\onevec =
\fourvec11{\vdots}1\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="ex-r2-meaning-1-2">
<ol class="lower-alpha ol-marker-1" id="ex-r2-meaning-1-2-1">
<li id="ex-r2-meaning-1-2-1-1">
<div class="para logical" id="ex-r2-meaning-1-2-1-1-1">
<div class="para">Explain why <span class="process-math">\(\bbar\text{,}\)</span> the mean of the components of <span class="process-math">\(\bvec\text{,}\)</span> can be found as the dot product</div>
<div class="displaymath process-math">
\begin{equation*}
\bbar = \frac 1m \bvec\cdot\onevec.
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.12.a"><a href="#ex-r2-meaning-1-2-1-1" title="Copy heading and permalink for Item 6.5.6.12.a" aria-label="Copy heading and permalink for Item 6.5.6.12.a">🔗</a></div>
</li>
<li id="ex-r2-meaning-1-2-1-2">
<div class="para" id="ex-r2-meaning-1-2-1-2-1">In the examples we have seen in this section, explain why <span class="process-math">\(\onevec\)</span> is in <span class="process-math">\(\col(A)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.12.b"><a href="#ex-r2-meaning-1-2-1-2" title="Copy heading and permalink for Item 6.5.6.12.b" aria-label="Copy heading and permalink for Item 6.5.6.12.b">🔗</a></div>
</li>
<li id="ex-r2-meaning-1-2-1-3">
<div class="para logical" id="ex-r2-meaning-1-2-1-3-1">
<div class="para">If we write <span class="process-math">\(\bvec = \bhat + \bvec^\perp\text{,}\)</span> explain why</div>
<div class="displaymath process-math">
\begin{equation*}
\bvec^\perp\cdot\onevec = 0
\end{equation*}
</div>
<div class="para">and hence why the mean of the components of <span class="process-math">\(\bvec^\perp\)</span> is zero.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.12.c"><a href="#ex-r2-meaning-1-2-1-3" title="Copy heading and permalink for Item 6.5.6.12.c" aria-label="Copy heading and permalink for Item 6.5.6.12.c">🔗</a></div>
</li>
<li id="ex-r2-meaning-1-2-1-4">
<div class="para" id="ex-r2-meaning-1-2-1-4-1">The variance of an <span class="process-math">\(m\)</span>-dimensional vector <span class="process-math">\(\vvec\)</span> is <span class="process-math">\(\var(\vvec) = \frac1m \len{\widetilde{\vvec}}^2\text{,}\)</span> where <span class="process-math">\(\widetilde{\vvec}\)</span> is the vector obtained by demeaning <span class="process-math">\(\vvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="ex-r2-meaning-1-2-1-4-2">
<div class="para">Explain why</div>
<div class="displaymath process-math">
\begin{equation*}
\var(\bvec) = \var(\bhat) + \var(\bvec^\perp).
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.12.d"><a href="#ex-r2-meaning-1-2-1-4" title="Copy heading and permalink for Item 6.5.6.12.d" aria-label="Copy heading and permalink for Item 6.5.6.12.d">🔗</a></div>
</li>
<li id="ex-r2-meaning-1-2-1-5">
<div class="para logical" id="ex-r2-meaning-1-2-1-5-1">
<div class="para">Explain why</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{\len{\bvec - A\xhat}^2}{\len{\widetilde{\bvec}}^2}
= \frac{\var(\bvec^\perp)}{\var(\bvec)}
\end{equation*}
</div>
<div class="para">and hence</div>
<div class="displaymath process-math">
\begin{equation*}
R^2 = \frac{\var(\bhat)}{\var(\bvec)} =
\frac{\var(A\xhat)}{\var(\bvec)}.
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-5-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="ex-r2-meaning-1-2-1-5-2">These expressions indicate why it is sometimes said that <span class="process-math">\(R^2\)</span> measures the “fraction of variance explained” by the function we are using to fit the data.  As seen in the previous exercise, there may be other features that are not recorded in the dataset that influence the quantity we wish to predict.<div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.12.e"><a href="#ex-r2-meaning-1-2-1-5" title="Copy heading and permalink for Item 6.5.6.12.e" aria-label="Copy heading and permalink for Item 6.5.6.12.e">🔗</a></div>
</li>
<li id="ex-r2-meaning-1-2-1-6">
<div class="para" id="ex-r2-meaning-1-2-1-6-1">Explain why <span class="process-math">\(0\leq R^2 \leq 1\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2-1-6-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item 6.5.6.12.f"><a href="#ex-r2-meaning-1-2-1-6" title="Copy heading and permalink for Item 6.5.6.12.f" aria-label="Copy heading and permalink for Item 6.5.6.12.f">🔗</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#ex-r2-meaning-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Exercise 6.5.6.12"><a href="#ex-r2-meaning" title="Copy heading and permalink for Exercise 6.5.6.12" aria-label="Copy heading and permalink for Exercise 6.5.6.12">🔗</a></div></article><div class="autopermalink" data-description="Exercises 6.5.6"><a href="#sec-least-squares-8" title="Copy heading and permalink for Exercises 6.5.6" aria-label="Copy heading and permalink for Exercises 6.5.6">🔗</a></div></section><div class="autopermalink" data-description="Section 6.5: Orthogonal least squares"><a href="#sec-least-squares" title="Copy heading and permalink for Section 6.5: Orthogonal least squares" aria-label="Copy heading and permalink for Section 6.5: Orthogonal least squares">🔗</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-gram-schmidt.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="chap7.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
