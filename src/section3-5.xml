<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-subspaces"
	 xmlns:xi="http://www.w3.org/2001/XInclude">

  <title> Subspaces </title>

  <introduction>
    <p> In this chapter, we have been looking at bases for
    <m>\real^p</m>, sets of vectors that are linearly independent and
    span <m>\real^p</m>.  Frequently, however, we focus on only a
    subset of <m>\real^p</m>.  In particular, if we are given an
    <m>m\times n</m> matrix <m>A</m>, we have been interested in both
    the span of the columns of <m>A</m> and the solution space to the
    homogeneous equation <m>A\xvec = \zerovec</m>.  In this section,
    we will expand the concept of basis to describe sets like these.
    </p>
    
    <exploration label="ula-preview-3-5">
      <introduction>
        <p> Let's consider the following matrix <m>A</m> and its reduced
        row echelon form.
        <me>
	  A = \left[\begin{array}{rrrr}
	  2 \amp -1 \amp 2 \amp 3 \\
	  1 \amp 0 \amp 0 \amp 2 \\
	  -2 \amp 2 \amp -4 \amp -2 \\
	  \end{array}\right]
	  \sim
	  \left[\begin{array}{rrrr}
	  1 \amp 0 \amp 0 \amp 2 \\
	  0 \amp 1 \amp -2 \amp 1 \\
	  0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right]
        </me>.
        </p>
      </introduction>

      <task label="ula-preview-3-5-a">
        <statement>
	  <p> Are the columns of <m>A</m> linearly independent?  Is
	  the span of the columns <m>\real^3</m>?
	  </p>
        </statement>
        <response component="rs-preview"/>
        <solution>
	  <p> The columns of <m>A</m> are not linearly independent
	  since there is not a pivot position in every column.  Also,
	  the span of the columns is not <m>\real^3</m> because there
	  is not a pivot position in every row. </p>
        </solution>
      </task>

      <task label="ula-preview-3-5-b">
        <statement>
	  <p> Give a parametric description of the solution space to
	  the homogeneous equation <m>A\xvec = \zerovec</m>. </p>
        </statement>
        <response component="rs-preview"/>
        <solution>
	  <p> From the reduced row echelon form, we see that the
	  homogeneous equation leads to the equations
	  <me>
	    \begin{alignedat}{5}
	    x_1 \amp  \amp  \amp  \amp  \amp  {}+{}  \amp 2x_4 \amp
	    {}={}  \amp 0 \\ 
	    \amp  \amp x_2 \amp  {}-{}  \amp 2x_3 \amp  {}+{}  \amp
	    x_4 \amp {}={}  \amp 0\text{,} \\ 
	    \end{alignedat}
	  </me>
	  which leads to the parametric description
	  <me>
	    \xvec=\fourvec{x_1}{x_2}{x_3}{x_4} =
	    \fourvec{-2x_4}{2x_3-x_4}{x_3}{x_4} =
	    x_3\fourvec{0}{2}{1}{0} + x_4\fourvec{2}{-1}{0}{1}\text{.}
	  </me>
	  </p>
        </solution>
      </task>

      <task label="ula-preview-3-5-c">
        <statement>
	  <p> Explain how this parametric description produces two
	  vectors <m>\wvec_1</m> and <m>\wvec_2</m> whose span is the
	  solution space to the equation <m>A\xvec = \zerovec</m>.
	  </p>
        </statement>
        <response component="rs-preview"/>
        <solution>
	  <p> We see that every vector in the solution space is a
	  linear combination of the vectors
	  <m>\wvec_1=\fourvec{0}{2}{1}{0}</m> and <m>\wvec_2 =
	  \fourvec{2}{-1}{0}{1}</m>.
	  </p>
        </solution>
      </task>

      <task label="ula-preview-3-5-d">
        <statement>
	  <p> What can you say about the linear independence of the
	  set of vectors <m>\wvec_1</m> and <m>\wvec_2</m>? </p>
        </statement>
        <response component="rs-preview"/>
        <solution>
	  <p> This pair of vectors is linearly independent because one
	  is not a scalar multiple of the other. </p>
        </solution>
      </task>

      <task label="ula-preview-3-5-e">
        <statement>
	  <p> Let's denote the columns of <m>A</m> as
	  <m>\vvec_1</m>,
	  <m>\vvec_2</m>,
	  <m>\vvec_3</m>,  and
	  <m>\vvec_4</m>.
	  Explain why <m>\vvec_3</m> and <m>\vvec_4</m> can be written
	  as linear combinations of <m>\vvec_1</m> and <m>\vvec_2</m>.
	  </p>
        </statement>
        <response component="rs-preview"/>
        <solution>
	  <p> From the reduced row echelon form of <m>A</m>, we
	  see that <m>\vvec_3 = -2\vvec_2</m> and
	  <m>\vvec_4=2\vvec_1+\vvec_2</m>. </p>
        </solution>
      </task>

      <task label="ula-preview-3-5-f">
        <statement>
	  <p> Explain why <m>\vvec_1</m> and <m>\vvec_2</m> are
	  linearly independent and <me>\laspan{\vvec_1,\vvec_2} =
	  \laspan{\vvec_1, \vvec_2, \vvec_3, \vvec_4}.</me>
	  </p>
        </statement>
        <response component="rs-preview"/>
        <solution>
	  <p> We see that <m>\vvec_1</m> and <m>\vvec_2</m> are
	  linearly independent from the reduced row echelon form of
	  <m>A</m>.  Moreover, we know that <m>\vvec_3</m> and
	  <m>\vvec_4</m> can be written as linear combinations of
	  <m>\vvec_1</m> and <m>\vvec_2</m>.  Therefore, any linear
	  combination of <m>\vvec_1</m>, <m>\vvec_2</m>,
	  <m>\vvec_3</m>, and <m>\vvec_4</m> can be written as a
	  linear combination of <m>\vvec_1</m> and <m>\vvec_2</m>
	  alone. </p>
        </solution>
      </task>

      <task component="rs-preview">
        <query label="ula-preview-3-5-poll" visibility="instructor">
          <statement>
            <p>I feel confident with the material in this activity.</p>
          </statement>
          <choices>
            <choice><p>Strongly Agree</p></choice>
            <choice><p>Agree</p></choice>
            <choice><p>Neutral</p></choice>
            <choice><p>Disagree</p></choice>
            <choice><p>Strongly Disagree</p></choice>
          </choices>
        </query>
      </task>

      <task component="rs-preview"
            label="ula-preview-3-5-what-else">
        <statement>
          <p>What would you need to know to feel
          more confident about this material?</p>
        </statement>
        <response/>
      </task>
    </exploration>
  </introduction>

  <subsection>
    <title> Subspaces </title>

    <p>
      Our goal is to develop a common framework for describing subsets
      like the span of the columns of a matrix and the solution space
      to a homogeneous equation.  That leads us to the following
      definition. 
    </p>

    <definition>
      <idx> subspace </idx>
      <statement>
	<p>
	  A <term>subspace</term> of <m>\real^p</m> is a subset of
	  <m>\real^p</m> that is the span of a set of vectors.
	</p>
      </statement>
    </definition>

    <p>
      Since we have explored the concept of span in some detail, this
      definition just gives us a new word to describe something
      familiar.  Let's look at some examples.
    </p>

    <example>
      <title> Subspaces of <m>\real^3</m> </title>

      <p>
	In <xref ref="activity-span-r3"/> and the following
	discussion, we looked at subspaces in <m>\real^3</m> without
	explicitly using that language.  Let's recall some of those
	examples.
	<ul>
	  <li>
	    <p>
	      <sidebyside widths="45% 50%">
		<p>
		  Suppose we have a single nonzero vector
		  <m>\vvec</m>.  The span of <m>\vvec</m> is a
		  subspace, which we'll write as <m>S =
		  \laspan{\vvec}</m>.  As we have seen, the span of a
		  single vector consists of all scalar multiples
		  of that vector, and these form a line passing
		  through the origin.
		</p>
		<image source="images/3d-line" />
	      </sidebyside>
	    </p>
	  </li>
	  <li>
	    <sidebyside widths="45% 50%">
	      <p>
		If instead we have two linearly independent vectors
		<m>\vvec_1</m> and <m>\vvec_2</m>, the subspace
		<m>S=\laspan{\vvec_1,\vvec_2}</m> is a plane passing
		through the origin.
	      </p>
	      <image source="images/3d-plane-nonstd" />
	    </sidebyside>
	  </li>

	  <li>
	    <p>
	      Consider the three vectors <m>\evec_1</m>,
	      <m>\evec_2</m>, and <m>\evec_3</m>. Since we know that
	      every 3-dimensional vector can be written as a linear
	      combination, we have <m>S = \laspan{\evec_1, \evec_2,
	      \evec_3} = \real^3</m>.  
	    </p>
	  </li>

	  <li>
	    <p>
	      One more subspace worth mentioning is
	      <m>S=\laspan{\zerovec}</m>.  Since any linear
	      combination of the zero vector is itself the zero
	      vector, this subspace consists of a single vector,
	      <m>\zerovec</m>. 
	    </p>
	  </li>
	</ul>
      </p>

      <p>
	In fact, any subspace of <m>\real^3</m> is one of these types:
	the origin, a line, a plane, or all of <m>\real^3</m>.
      </p>
      
    </example>

    <activity>
      <statement>
	<p>
	  We will look at some sets of vectors and
	  the subspaces they form.
	  <ol marker="a.">
	    <li>
	      <p>
		If <m>\vvec_1, \vvec_2,\ldots,\vvec_n</m> is a set of
		vectors in <m>\real^m</m>, explain why <m>\zerovec</m> can
		be expressed as a 
		linear combination of these vectors.  Use this fact to
		explain why the zero vector <m>\zerovec</m> belongs to any
		subspace in <m>\real^m</m>.  
	      </p>
	    </li>

	    <li>
	      <p>
		Explain why the line on the left of <xref
		ref="figure-lines-r2"/> is not a subspace of
		<m>\real^2</m> and why the line on the right is.
	      </p>

	      <figure xml:id="figure-lines-r2">
		<caption> Two lines in <m>\real^2</m>, one of which is a
		subspace and one of which is not.
		</caption>
		<sidebyside widths="40% 40%" margins="5% 5%">
		  <image source="images/subspace-line-skew" />
		  <image source="images/subspace-line-origin" />
		</sidebyside>
	      </figure>
	    </li>

	    <li>
	      <p>
		Consider the vectors
		<me>
		  \vvec_1=\threevec101,~~~
		  \vvec_2=\threevec011,~~~
		  \vvec_3=\threevec110,
		</me>
		and describe the subspace
		<m>S=\laspan{\vvec_1,\vvec_2,\vvec_3}</m> of
		<m>\real^3</m>.
		<sage>
		  <input>
		  </input>
		</sage>
	      </p>
	    </li>

	    <li>
	      <p>
		Consider the vectors
		<me>
		  \wvec_1=\threevec210,~~~
		  \wvec_2=\threevec{-1}1{-1},~~~
		  \wvec_3=\threevec03{-2}
		</me>
		<ol marker="1.">
		  <li>
		    <p>
		      Write <m>\wvec_3</m> as a linear combination of
		      <m>\wvec_1</m> and <m>\wvec_2</m>.
		    </p>
		  </li>
		  <li>
		    <p>
		      Explain why <m>\laspan{\wvec_1,\wvec_2,\wvec_3} =
		      \laspan{\wvec_1, \wvec_2}</m>.
		    </p>
		  </li>
		  <li>
		    <p>
		      Describe the subspace <m>S =
		      \laspan{\wvec_1,\wvec_2,\wvec_3}</m> of <m>\real^3</m>.
		    </p>
		  </li>
		</ol>
	      </p>
	    </li>
	    <li>
	      <p>
		Suppose that <m>\vvec_1</m>, <m>\vvec_2</m>,
		<m>\vvec_3</m>, and <m>\vvec_4</m> are four vectors in
		<m>\real^3</m> and that
		<me>
		  \begin{bmatrix}
		  \vvec_1 \amp \vvec_2 \amp \vvec_3 \amp \vvec_4
		  \end{bmatrix}
		  \sim
		  \begin{bmatrix}
		  1 \amp 2 \amp 0 \amp -2 \\
		  0 \amp 0 \amp 1 \amp 1 \\
		  0 \amp 0 \amp 0 \amp 0 \\
		  \end{bmatrix}.
		</me>
		Give a description of the subspace
		<m>S=\laspan{\vvec_1,\vvec_2,\vvec_3,\vvec_4}</m> of
		<m>\real^3</m>. 
	      </p>
	    </li>
	  </ol>
	</p>
      </statement>

      <solution>
	<p>
	  <ol marker="a.">
	    <li>
	      <p>
		If we choose all the weights <m>c_1=c_2=\ldots=c_n =
		0</m>, then the linear combination
		<me>
		  c_1\vvec_1 + c_2\vvec_2 + \cdots + c_n\vvec_n = \zerovec.
		</me>
		This means that <m>\zerovec</m> is the subspace
		<m>S=\laspan{\vvec_1,\vvec_2,\ldots,\vvec_n}</m>. 		
	      </p>
	    </li>
	    <li>
	      <p>
		The line on the left cannot be a subspace of
		<m>\real^2</m> since it does not contain the zero
		vector.  The line on the right is a subspace because
		it can be represented as the span of any nonzero
		vector on the line.
	      </p>
	    </li>
	    <li>
	      <p>
		The matrix whose columns are the given vectors has a
		pivot in every row.  Therefore, the span of these
		vectors is <m>\real^3</m> and so
		<m>S=\laspan{\vvec_1,\vvec_2,\vvec_3} = \real^3</m>.
	      </p>
	    </li>
	    <li>
	      <p>
		<ol marker="1.">
		  <li>
		    <p>
		      We see that <m>\wvec_3 = \wvec_1 + 2\wvec_2</m>.
		    </p>
		  </li>
		  <li>
		    <p>
		      Any linear combination
		      <me>
			c_1\wvec_1 + c_2\wvec_2 + c_2\wvec_3 =
			(c_1 + c_2)\wvec_1 + (c_2+2c_2)\wvec_2.
		      </me>
		    </p>
		  </li>
		  <li>
		    <p>
		      The subspace
		      <m>S=\laspan{\wvec_1,\wvec_2,\wvec_3} =
		      \laspan{\wvec_1,\wvec_2}</m> is a plane in
		      <m>\real^3</m>. 
		    </p>
		  </li>
		</ol>
	      </p>
	    </li>
	    <li>
	      <p>
		Since we can write <m>\vvec_2 = 2\vvec_1</m> and
		<m>\vvec_4 = -2\vvec_1 + \vvec_2</m>, then
		<me>
		  S = \laspan{\vvec_1,\vvec_2,\vvec_3,\vvec_4} =
		  \laspan{\vvec_1,\vvec_3},
		</me>
		which is a plane in <m>\real^3</m>.
	      </p>
	    </li>
	  </ol>
	</p>
      </solution>
	  
    </activity>

    <p>
      As the activity shows, it is possible to represent some
      subspaces as the span of more than one set of vectors.  We are
      particularly interested in representing a subspace as the span
      of a linearly independent set of vectors.
    </p>

    <definition>
      <statement>
	<idx> dimension </idx>
	<p> A <em>basis</em> for a subspace <m>S</m> of <m>\real^p</m>
	is a set of vectors in <m>S</m> that are linearly independent
	and whose span is <m>S</m>.  We say that the
	<em>dimension</em> of the subspace <m>S</m>, denoted <m>\dim
	S</m>, is the number of vectors in any basis.
	</p>
      </statement>
    </definition>

    <example>
      <title> A subspace of <m>\real^4</m> </title>

      <p>
	Suppose we have the 4-dimensional vectors <m>\vvec_1</m>,
	<m>\vvec_2</m>, and <m>\vvec_3</m> that define the subspace
	<m>S = \laspan{\vvec_1,\vvec_2,\vvec_3}</m> of
	<m>\real^4</m>.  Suppose also that
	<me>
	  \begin{bmatrix}
	  \vvec_1 \amp \vvec_2 \amp \vvec_3
	  \end{bmatrix}
	  \sim
	  \begin{bmatrix}
	  1 \amp -1 \amp 0 \\
	  0 \amp 0 \amp 1 \\
	  0 \amp 0 \amp 0 \\
	  0 \amp 0 \amp 0 \\
	  \end{bmatrix}.
	</me>
	From the reduced row echelon form of the matrix, we see that
	<m>\vvec_2 = -\vvec</m>.  Therefore, any linear combination
	of <m>\vvec_1</m>, <m>\vvec_2</m>, and <m>\vvec_3</m> can be
	rewritten 
	<me>
	  c_1\vvec_1 + c_2\vvec_2 + c_3 \vvec_3 =
	  (c_1-c_2)\vvec_1 + c_2\vvec_3
	</me>
	as a linear combination of <m>\vvec_1</m> and <m>\vvec_3</m>.
	This tells us that
	<me>
	  S = \laspan{\vvec_1,\vvec_2,\vvec_3}
	  = \laspan{\vvec_1,\vvec_3}.
	</me>
      </p>
      <p>
	Furthermore, the reduced row echelon form of the matrix shows
	that <m>\vvec_1</m> and <m>\vvec_3</m> are linearly
	independent.  Therefore, <m>\{\vvec_1,\vvec_3\}</m> is a basis
	for <m>S</m>, which means that <m>S</m> is a two-dimensional
	subspace of <m>\real^4</m>.
      </p>
    </example>

    <p>
      Subspaces of <m>\real^3</m> are either
      <ul>
	<li>
	  <p>
	    0-dimensional, consisting of the single vector
	    <m>\zerovec</m>,
	  </p>
	</li>
	<li>
	  <p>
	    a 1-dimensional line,
	  </p>
	</li>
	<li>
	  <p>
	    a 2-dimensional plane, or
	  </p>
	</li>
	<li>
	  <p>
	    the 3-dimensional subspace <m>\real^3</m>.
	  </p>
	</li>
      </ul>
      There is no 4-dimensional subspace of
      <m>\real^3</m> because there is no linearly independent set of
      four vectors in <m>\real^3</m>.
    </p>

    <p>
      There are two important subspaces associated to any matrix, each
      of which springs from one of our
      <xref ref="fundamental-questions" text="custom">
	two fundamental questions,
      </xref>
      as we will now see.
    </p>

  </subsection>

  <subsection>
    <title> The column space of <m>A</m> </title>

    <p>
      The first subspace associated to a matrix that we'll consider is
      its column space. 
    </p>

    <definition>
      <statement>
	<idx> column space </idx>
	<p> If <m>A</m> is an <m>m\times n</m> matrix, we call the
	span of its columns the <em>column space</em> of <m>A</m> and
	denote it as <m>\col(A)</m>.
	</p>
      </statement>
    </definition>

    <p>
      Notice that the columns of <m>A</m> are vectors in
      <m>\real^m</m>, which means that any linear combination of the
      columns is also in <m>\real^m</m>.  Since the column space is
      described as the span of a set of vectors, we see that
      <m>\col(A)</m> is
      a subspace of <m>\real^m</m>.
    </p>

    <activity>
      <statement>
      <p> We will explore some column spaces in this activity.
      <ol marker="a.">
	<li><p>
	  Consider the matrix
	  <me>A= \left[\begin{array}{rrr}
	  \vvec_1 \amp \vvec_2 \amp \vvec_3
	  \end{array}\right]
	  =
	  \left[\begin{array}{rrr}
	  1 \amp 3 \amp -1 \\
	  -2 \amp 0 \amp -4 \\
	  1 \amp 2 \amp 0 \\
	  \end{array}\right].
	  </me>
	  Since <m>\col(A)</m> is the span of the columns,
	  we have
	  <me>
	    \col(A) = \laspan{\vvec_1,\vvec_2,\vvec_3}.
	  </me>
	  Explain why <m>\vvec_3</m> can be written as a linear
	  combination of <m>\vvec_1</m> and <m>\vvec_2</m> and
	  why <m>\col(A)=\laspan{\vvec_1,\vvec_2}</m>.
	</p> </li>

	<li><p> Explain why the vectors <m>\vvec_1</m> and
	<m>\vvec_2</m> form a basis for <m>\col(A)</m> and why
	<m>\col(A)</m> is a 2-dimensional subspace of
	<m>\real^3</m> and therefore a plane. </p></li>

	<li><p> Now consider the matrix <m>B</m> and its reduced row
	echelon form:
	<me>
	  B = \left[\begin{array}{rrrr}
	  -2 \amp -4 \amp 0 \amp 6 \\
	  1 \amp 2 \amp 0 \amp -3 \\
	  \end{array}\right]
	  \sim
	  \left[\begin{array}{rrrr}
	  1 \amp 2 \amp 0 \amp -3 \\
	  0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right].
	</me>
	Explain why <m>\col(B)</m> is a 1-dimensional
	subspace of <m>\real^2</m> and is therefore a line.
	</p></li>

	<li><p> For a general matrix <m>A</m>, what is the
	relationship between the dimension 
	<m>\dim~\col(A)</m> and the number of pivot positions in
	<m>A</m>? </p></li>

	<li><p> How does the location of the pivot positions indicate
	a basis for <m>\col(A)</m>?
	</p></li>

	<li><p> If <m>A</m> is an invertible <m>9\times9</m> matrix,
	what can you say about the column space <m>\col(A)</m>?
	</p></li>

	<li>
	  <p> Suppose that <m>A</m> is an <m>8\times 10</m> matrix and
	  that <m>\col(A) = \real^8</m>.  If <m>\bvec</m> is an
	  8-dimensional vector, what can you say about the equation
	  <m>A\xvec = \bvec</m>?
	  </p>
	</li>

      </ol></p>
      </statement>

      <solution>
	<p><ol marker="a.">
	  <li><p>  We have
	  <me>A=\left[\begin{array}{rrr}
	  1 \amp 3 \amp -1 \\
	  -2 \amp 0 \amp -4 \\
	  1 \amp 2 \amp 0 \\
	  \end{array}\right]\sim
	  \left[\begin{array}{rrr}
	  1 \amp 0 \amp 2 \\
	  0 \amp 1 \amp -1 \\
	  0 \amp 0 \amp 0 \\
	  \end{array}\right]\text{,}
	  </me>
	  which shows that the vectors are not linearly
	  independent and, in fact, that <m>\vvec_3 = 2\vvec_1 -
	  \vvec_2</m>.  As we've seen several times, this means that
	  any linear combination of <m>\vvec_1</m>, <m>\vvec_2</m>, and
	  <m>\vvec_3</m> can be written as a linear combination of
	  <m>\vvec_1</m> and <m>\vvec_2</m> alone and hence that
	  <me>\col(A)=\laspan{\vvec_1,\vvec_2,\vvec_3} =
	  \laspan{\vvec_1,\vvec_2}.</me>  
	  </p></li>

	  <li><p> The reduced row echelon form of <m>A</m> shows that
	  <m>\vvec_1</m> and <m>\vvec_2</m> are linearly independent.
	  We also know that the span of these two vectors is
	  <m>\col(A)</m>.  Therefore, they form a basis for
	  <m>\col(A)</m>. </p></li>

	  <li><p> Denoting the columns of <m>B</m> as <m>\vvec_i</m>,
	  the reduced row echelon form shows that
	  <m>\vvec_2=2\vvec_1</m>, <m>\vvec_3=0\vvec_1</m>, and
	  <m>\vvec_4 = -3\vvec_1</m>.
	  Therefore, any linear combination of <m>\vvec_1</m>,
	  <m>\vvec_2</m>, <m>\vvec_3</m>, and <m>\vvec_4</m> can be
	  written as a linear combination of <m>\vvec_1</m>
	  alone.  This means that <m>\vvec_1</m> forms a basis for
	  <m>\col(A)</m>, which is then the line consisting of all
	  scalar multiples of <m>\vvec_1</m>.
p	  </p></li>

	  <li><p> The number of vectors in a basis of <m>\col(A)</m>
	  equals the number of pivot positions.  Therefore,
	  <m>\dim~\col(A)</m> equals the number of pivot positions in
	  <m>A</m>. </p></li>

	  <li><p> As the examples in this activity illustrate, the
	  columns of <m>A</m> that contain pivot positions form a
	  basis for <m>\col(A)</m>.
	  </p></li>

	  <li><p> If <m>A</m> is invertible, then it has a pivot
	  position in every row, which means that the span of the
	  columns is <m>\real^9</m>.  Therefore, <m>\col(A) =
	  \real^9</m>. </p></li>

	  <li><p> Since <m>\col(A)=\real^8</m>, we know that every
	  8-dimensional vector <m>\bvec</m> is in <m>\col(A)</m>.
	  This means that <m>\bvec</m> is in the span of the columns
	  of <m>A</m> so the equation <m>A\xvec = \bvec</m> must be
	  consistent. </p></li>

	</ol></p>
      </solution>
    </activity>

    <example xml:id="example-col-basis">
      <p>
	Consider the matrix <m>A</m> and its
	reduced row echelon form:
	<me>
	  A =
	  \left[\begin{array}{rrrrr}
	  2 \amp 0 \amp -4 \amp -6 \amp 0 \\
	  -4 \amp -1 \amp 7 \amp 11 \amp 2 \\
	  0 \amp -1 \amp -1 \amp -1 \amp 2 \\
	  \end{array}\right]
	  \sim
	  \left[\begin{array}{rrrrr}
	  1 \amp 0 \amp -2 \amp -3 \amp 0 \\
	  0 \amp 1 \amp 1 \amp 1 \amp -2 \\
	  0 \amp 0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right],
	  </me>
	  and denote the columns of <m>A</m> as
	  <m>\vvec_1,\vvec_2,\ldots,\vvec_5</m>.
      </p>
      
      <p> It is certainly true that <m>\col(A) =
      \laspan{\vvec_1,\vvec_2,\ldots,\vvec_5}</m> by the definition of
      the column space.  However, the reduced row echelon form of the
      matrix shows us that the vectors are not linearly independent so
      <m>\vvec_1,\vvec_2,\ldots,\vvec_5</m> do not form a basis for
      <m>\col(A)</m>. 
      </p>
      
      <p> From the reduced row echelon form, however, we can see that
      <me>
	\begin{aligned}
	\vvec_3 \amp {}={} -2\vvec_1 + \vvec_2 \\
	\vvec_4 \amp {}={} -3\vvec_1 + \vvec_2 \\
	\vvec_5 \amp {}={} -2\vvec_2 \\
	\end{aligned}
	</me>.
	This means that any linear combination of
	<m>\vvec_1,\vvec_2,\ldots,\vvec_5</m> can be written as a linear
	combination of just <m>\vvec_1</m> and <m>\vvec_2</m>.  Therefore,
	we see that <m>\col(A) = \laspan{\vvec_1,\vvec_2}</m>.
      </p>

      <p>
	Moreover,
	the reduced row echelon form shows that <m>\vvec_1</m> and
	<m>\vvec_2</m> are linearly independent, which implies that they
	form a basis for <m>\col(A)</m>.  This means that
	<m>\col(A)</m> is a 
	2-dimensional subspace of <m>\real^3</m>, which is a plane in
	<m>\real^3</m>, having basis
	<me>
	  \threevec{2}{-4}{0},
	  \qquad
	  \threevec{0}{-1}{1}
	  </me>.
      </p>
    </example>
      
    <p> In general, a column without a pivot position can be written
    as a linear combination of the columns that have pivot positions.
    This means that a basis for <m>\col(A)</m> will always be given by
    the columns of <m>A</m> having pivot positions.  This leads us to
    the following definition and proposition.
    </p>

    <definition>
      <idx> rank </idx>
      <idx> matrix, rank </idx>
      <statement>
	<p>
	  The <term>rank</term> of a matrix <m>A</m> is the number of
	  pivot positions in <m>A</m> and is denoted by
	  <m>\rank(A)</m>.
	</p>
      </statement>
    </definition>

    <proposition xml:id="proposition-col-dim">
      <statement>
	<p>
	  If <m>A</m> is an <m>m\times n</m> matrix, then
	  <m>\col(A)</m> is a subspace of <m>\real^m</m> whose
	  dimension equals <m>\rank(A)</m>.  The columns of <m>A</m>
	  that contain pivot positions form a basis for <m>\col(A)</m>.
	</p>
      </statement>
    </proposition>

    <p>
      For example, the rank of the matrix <m>A</m> in <xref
      ref="example-col-basis"/> is two because there are two pivot
      positions.  A basis for <m>\col(A)</m> is given by the first two
      columns of <m>A</m> since those columns have pivot positions.
    </p>

    <p>
      As a note of caution, we determine the pivot positions by
      looking at the reduced row echelon form of <m>A</m>.  However,
      we form a basis of <m>\col(A)</m> from the columns of <m>A</m>
      rather than the columns of the reduced row echelon matrix.
    </p>

  </subsection>

  <subsection>
    <title> The null space of <m>A</m> </title>

    <p>
      The second subspace associated to a matrix is its null space.
    </p>
    
    <definition>
      <statement>
	<idx> null space </idx>
	<p> If <m>A</m> is an <m>m\times n</m> matrix, we call the
	subset of vectors <m>\xvec</m> in <m>\real^n</m> satisfying
	<m> A\xvec = \zerovec</m> the <em>null space</em> of
	<m>A</m> and denote it by <m>\nul(A)</m>.
	</p>
      </statement>
    </definition>

    <p>
      Remember that a subspace is a subset that can be represented as
      the span of a set of vectors.  The column space of <m>A</m>,
      which is simply the span of the columns of <m>A</m>, fits this
      definition.  It may not be immediately clear how the null space of
      <m>A</m>, which is the solution space of the equation <m>A\xvec
      = \zerovec</m>, does, but we will see that <m>\nul(A)</m> is a
      subspace of <m>\real^n</m>.
    </p>

    <activity>
      <statement>
      <p> We will explore some null spaces in this activity and see
      why <m>\nul(A)</m> satisfies the definition of a subspace.
      <ol marker="a.">
	<li><p>
	  Consider the matrix
	  <me>A=\begin{bmatrix}
	  1 \amp 3 \amp -1 \amp 2 \\
	  -2 \amp 0 \amp -4 \amp 2 \\
	  1 \amp 2 \amp 0 \amp 1
	  \end{bmatrix}
	  </me>
	  and give a parametric description of the solution space to
	  the equation <m>A\xvec = \zerovec</m>.  In other words, give
	  a parametric description of <m>\nul(A)</m>.
	  <sage>
	    <input>
	    </input>
	  </sage>
	</p></li>

	<li>
	  <p>
	    This parametric description shows that the vectors 
	    satisfying the equation <m>A\xvec=\zerovec</m> can be written as
	    a linear combination of a set of vectors.  In other words,
	    this description shows why <m>\nul(A)</m> is the span of a set
	    of vectors and is therefore a subspace.
	    Identify a set of vectors
	    whose span is <m>\nul(A)</m>.
	  </p>
	</li>

	<li>
	  <p> Use this set of vectors to find a basis for
	    <m>\nul(A)</m> and state the dimension of <m>\nul(A)</m>. 
	  </p>
	</li>

	<li><p> The null space <m>\nul(A)</m> is a subspace of
	<m>\real^p</m> for which value of <m>p</m>? </p></li>

	<li><p> Now consider the matrix <m>B</m> whose reduced row
	echelon form is given by
	<me>
	  B \sim
	  \left[\begin{array}{rrrr}
	  1 \amp 2 \amp 0 \amp -3 \\
	  0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right].
	</me>
	Give a parametric description of <m>\nul(B)</m>.  </p></li>

	<li>
	  <p>
	    The parametric description gives a set of vectors that span
	    <m>\nul(B)</m>.  Explain why this set of vectors is linearly
	    independent and hence forms a basis.  What is the dimension of
	    <m>\nul(B)</m>?
	  </p>
	</li>

	<li>
	  <p>
	    For a general matrix <m>A</m>, how does the number of
	    pivot positions indicate the dimension of <m>\nul(A)</m>?
	  </p>
	</li>

	<li>
	  <p>
	    Suppose that the columns of a matrix <m>A</m> are
	    linearly independent.  What can you say about
	    <m>\nul(A)</m>? 
	  </p>
	</li>

      </ol></p>
      </statement>

      <solution>
	<p><ol marker="a.">
	  <li><p>  We have
	  <me>A=\begin{bmatrix}
	  1 \amp 3 \amp -1 \amp 2 \\
	  -2 \amp 0 \amp -4 \amp 2 \\
	  1 \amp 2 \amp 0 \amp 1 \\
	  \end{bmatrix}\sim
	  \begin{bmatrix}
	  1 \amp 0 \amp 2 \amp -1 \\
	  0 \amp 1 \amp -1 \amp 1 \\
	  0 \amp 0 \amp 0 \amp 0\\
	  \end{bmatrix},
	  </me>
	  which leads to the parametric description of the solution
	  space to the homogeneous equation:
	  <me>\xvec=x_3\fourvec{-2}{1}{1}0 +
	  x_4\fourvec{1}{-1}01.
	  </me>
	  </p></li>

	  <li><p> The parametric description shows that every solution
	  to the equation <m>A\xvec=\zerovec</m> is a linear
	  combination of <m>\wvec_1=\fourvec{-2}110</m> and
	  <m>\wvec_2=\fourvec1{-1}01</m>. </p></li>

	  <li>
	    <p>
	      The vectors <m>\wvec_1</m> and <m>\wvec_2</m> are
	      linearly independent so they form a basis for
	      <m>\nul(A)</m>.  Therefore, <m>\nul(A)</m> is
	      2-dimensional.
	    </p>
	  </li>

	  <li><p>
	    The vectors in <m>\nul(A)</m> are 4-dimensional so
	    <m>\nul(A)</m> is a subspace of <m>\real^4</m>.
	  </p></li>

	  <li><p> A parametric description of the null space is
	  <m>\xvec=x_2\fourvec{-2}{1}{0}{0} + x_3\fourvec0010 + 
	  x_4\fourvec{3}{0}{-2}{1}</m>.  We can check that the vectors
	  <me>
	    \fourvec{-2}100,~~~\fourvec0010,~~~\fourvec30{-2}1
	  </me>
	  are linearly independent so they form a basis for
	  <m>\nul(A)</m>.  This means that <m>\nul(A)</m> is
	  3-dimensional. 
	  </p></li>

	  <li><p> The number of vectors in a basis of the null space
	  equals the number of free variables that appear in the
	  equation <m>A\xvec=\zerovec</m>, which is the number of columns
	  that do not have pivot positions.  This says that
	  <m>\dim~\nul(A)</m> equals the number of columns of <m>A</m>
	  minus the number of pivot positions. </p></li>

	  <li><p> If the columns are linearly independent, then the
	  homogeneous equation <m>A\xvec=\zerovec</m> has only the
	  zero solution <m>\xvec=\zerovec</m>.  Therefore,
	  <m>\nul(A) = \{\zerovec\}</m>. </p></li>

	</ol></p>
      </solution>
	    
    </activity>

    <example xml:id="example-null-intro">
      <p>
	Consider the matrix <m>A</m> along with its reduced row
	echelon form: 
	<me>
	  A =
	  \left[\begin{array}{rrrrr}
	  2 \amp 0 \amp -4 \amp -6 \amp 0 \\
	  -4 \amp -1 \amp 7 \amp 11 \amp 2 \\
	  0 \amp -1 \amp -1 \amp -1 \amp 2 \\
	  \end{array}\right]
	  \sim
	  \left[\begin{array}{rrrrr}
	  1 \amp 0 \amp -2 \amp -3 \amp 0 \\
	  0 \amp 1 \amp 1 \amp 1 \amp -2 \\
	  0 \amp 0 \amp 0 \amp 0 \amp 0 \\
	  \end{array}\right]\text{.}
	</me>
      </p>
      
      <p> To find a parametric description of the solution space to
      <m>A\xvec=\zerovec</m>, imagine that we augment both <m>A</m> and
      its reduced row echelon form by a column of zeroes, which leads
      to the equations
      <me>
	\begin{alignedat}{6}
	x_1 \amp  \amp  \amp  {}-{}  \amp 2x_3 \amp  {}-{}  \amp 3x_4 \amp
	\amp  \amp  {}={}  \amp 0 \\ 
	\amp  \amp x_2 \amp  {}+{}  \amp x_3 \amp  {}+{}  \amp x_4 \amp
	{}-{}  \amp 2x_5 \amp  {}={}  \amp 0. \\ 
	\end{alignedat}
      </me>
      Notice that <m>x_3</m>, <m>x_4</m>, and <m>x_5</m> are free
      variables so we rewrite these equations as
      <me>
	\begin{aligned}
	x_1 \amp {}={} 2x_3 + 3x_4 \\
	x_2 \amp {}={} -x_3 - x_4 + 2x_5. \\
	\end{aligned}
      </me>
      In vector form, we have
      <me>
	\begin{aligned}
	\xvec \amp {}={} \fivevec{x_1}{x_2}{x_3}{x_4}{x_5} =
	\fivevec{2x_3 + 3x_4}{-x_3-x_4+2x_5}{x_3}{x_4}{x_5}
	\\
	\\
	\amp {}={}
	x_3\fivevec{2}{-1}{1}{0}{0}
	+x_4\fivevec{3}{-1}{0}{1}{0}
	+x_5\fivevec{0}{2}{0}{0}{1}.
	\end{aligned}
      </me>
      </p>
      
      <p> This expression says that any vector <m>\xvec</m> satisfying
      <m>A\xvec= \zerovec</m> is a linear combination of the vectors
      <me>
	\vvec_1 = \fivevec{2}{-1}{1}{0}{0},~~~
	\vvec_2 = \fivevec{3}{-1}{0}{1}{0},~~~
	\vvec_3 = \fivevec{0}{2}{0}{0}{1}.
      </me>
      It is straightforward to check that these vectors are linearly
      independent, which means that <m>\vvec_1</m>, <m>\vvec_2</m>,
      and <m>\vvec_3</m> form a basis for <m>\nul(A)</m>, a
      3-dimensional subspace of <m>\real^5</m>.
      </p>

    </example>

    <p>
      As illustrated in this example, the dimension of <m>\nul(A)</m>
      is equal to the 
      number of free variables in the equation
      <m>A\xvec=\zerovec</m>, which equals the number of columns of
      <m>A</m> without pivot positions or the
      number of columns of <m>A</m> minus the number of pivot positions.   
    </p>

    <proposition xml:id="proposition-nul-dim">
      <statement>
	<p>
	  If <m>A</m> is an <m>m\times n</m> matrix, then
	  <m>\nul(A)</m> is a subspace of <m>\real^n</m> whose
	  dimension is
	  <me>
	    \dim~\nul(A) = n - \rank(A).
	  </me>
	</p>
      </statement>
    </proposition>

    <p>
      Combining <xref ref="proposition-col-dim"/> and <xref
      ref="proposition-nul-dim"/> shows that
    </p>

    <proposition>
      <statement>
	<p>
	  If <m>A</m> is an <m>m\times n</m> matrix, then
	  <me>
	    \dim~\col(A) + \dim~\nul(A) = n.
	  </me>
	</p>
      </statement>
    </proposition>

  </subsection>

  <subsection>
    <title> Summary </title>

    <p> Once again, we find ourselves revisiting
    <xref ref="fundamental-questions" text="custom">
    our two fundamental questions
    </xref>
    concerning the existence and uniqueness of solutions to linear
    systems.  The column space <m>\col(A)</m> contains all the vectors
    <m>\bvec</m> for which the equation <m>A\xvec = \bvec</m> is
    consistent. The null space <m>\nul(A)</m> is the solution
    space to the equation <m>A\xvec = \zerovec</m>, which reflects on
    the uniqueness of solutions to this and other equations.
    </p>

    <p>
      <ul>
	<li><p> A subspace <m>S</m> of <m>\real^p</m> is a subset of
	<m>\real^p</m> that can be represented as the span of a set of
	vectors.  A basis of <m>S</m> is a linearly
	independent set of vectors whose span is
	<m>S</m>. </p></li>

	<li><p> If <m>A</m> is an <m>m\times n</m> matrix, the column
	space <m>\col(A)</m> is the span of the 
	columns of <m>A</m> and forms a subspace of <m>\real^m</m>.
	</p></li>

	<li><p> A basis for <m>\col(A)</m> is found from the columns
	of <m>A</m> that have pivot positions.  The dimension is
	therefore <m>\dim~\col(A) = \rank(A)</m>.
	</p></li>

	<li><p> The
	null space <m>\nul(A)</m> is the solution space to the
	homogeneous equation <m>A\xvec = \zerovec</m> and is a
	subspace of <m>\real^n</m>.  </p></li>

	<li><p> A basis for <m>\nul(A)</m> is found through a
	parametric description of the solution space of <m>A\xvec =
	\zerovec</m>, and we have that <m>\dim~\nul(A) = n -
	\rank(A)</m>.  </p></li>

      </ul>
    </p>

    <exercise component="proteus"
              label="ula-proteus-3-5-def-subspace">
      <title>Defining the column space</title>

      <statement>
        <p>Select the best definition of the column space
        <m>\col(A)</m> of a matrix <m>A</m>.</p>
      </statement>

      <choices>
        <choice>
          <statement>
            <p>The columns of <m>A</m> that have a pivot position.</p>
          </statement>
          <feedback>This is the algorithm for finding a basis for
          <m>\col(A)</m> but not the definition.</feedback>
        </choice>
        <choice>
          <statement>
            <p>The vectors <m>\bvec</m> for which <m>A\xvec =\bvec</m>
            is consistent.
            </p>
          </statement>
          <feedback>This is a consequence of the definition but not
          the simplest way in which to think about
          <m>\col(A)</m>.</feedback>
        </choice>
        <choice>
          <statement>
            <p>The span of <m>A</m>.</p>
          </statement>
          <feedback>We refer to the span of a set of vectors and
          not the span of a matrix.</feedback>
        </choice>
        <choice correct="yes">
          <statement>
            <p>The span of the columns of <m>A</m>.</p>
          </statement>
        <feedback>This is correct!  You may wish to select the other
        choices and consider why each is not the best
        definition.</feedback>
        </choice>
      </choices>
    </exercise>

    <exercise component="proteus"
              label="ula-proteus-3-5-subspace-short-ans">
      <title>Describing properties of subspaces</title>

      <task label="ula-proteus-3-5-subspace-short-ans-a">
        <statement>
          <p>What do we mean by a subspace of <m>\real^n</m>?</p>
        </statement>
        <response/>
      </task>

      <task label="ula-proteus-3-5-subspace-short-ans-b">
        <statement>
          <p>What do we mean by a basis for a subspace of
          <m>\real^n</m>?</p> 
        </statement>
        <response/>
      </task>

      <task label="ula-proteus-3-5-subspace-short-ans-c">
        <statement>
          <p>Explain in your own words why the zero vector
          <m>\zerovec</m> must be in every subspace of <m>\real^n</m>.
          </p>
        </statement>
        <response/>
      </task>

      <task label="ula-proteus-3-5-subspace-short-ans-d">
        <statement>
          <p>If <m>A</m> is a <m>10\times 8</m> matrix with
          <m>\rank(A) = 7</m>, what do we know about
          <m>\dim~\col(A)</m>?</p>
        </statement>
        <response/>
      </task>

      <task label="ula-proteus-3-5-subspace-short-ans-e">
        <statement>
          <p>If <m>A</m> is a <m>10\times 8</m> matrix with
          <m>\rank(A) = 7</m>, what do we know about
          <m>\dim~\nul(A)</m>?</p>
        </statement>
        <response/>
      </task>

    </exercise>

    <exercise component="proteus"
              label="ula-proteus-3-5-eltsofspaces-v1">
      <title>Determining elements of spaces</title>
      <statement>
        <p>Consider the matrix <m>A</m> and its reduced row
        echelon form:
        <me>
          A=
          \begin{bmatrix}
          3 \amp 1 \amp -5 \amp 0 \\
          1 \amp 1 \amp -1 \amp -4 \\
          2 \amp 0 \amp  -4\amp 4 \\
          1 \amp 0 \amp  -2\amp 1
          \end{bmatrix} \sim
          \begin{bmatrix}
          1 \amp 0 \amp -2 \amp 0 \\
          0 \amp 1 \amp  1 \amp 0 \\
          0 \amp 0 \amp  0 \amp 1 \\
          0 \amp 0 \amp  0 \amp 0
          \end{bmatrix}
        </me>.
        If possible, determine if the given vectors are in
        <m>\nul(A)</m> and/or <m>\col(A)</m>.</p>
      </statement>

      <cardsort>
        <match>
          <premise><m>\fourvec{2}{-1}{1}{0}</m></premise>
          <response><p>In <m>\nul(A)</m>, but not in
          <m>\col(A)</m>.</p></response>
        </match>
        <match>
          <premise><m>\fourvec{3}{1}{2}{1}</m></premise>
          <premise><m>\fourvec{4}{-2}{6}{2}</m></premise>
          <premise><m>\fourvec{-5}{-1}{-4}{-2}</m></premise>
          <response><p>In <m>\col(A)</m>, but not in
          <m>\nul(A)</m>.</p></response>
        </match>

        <match>
          <premise><m>\fourvec{1}{0}{0}{0}</m></premise>
          <premise><m>\fivevec{1}{1}{0}{0}{0}</m></premise>
          <response><p>In neither <m>\nul(A)</m> nor
          <m>\col(A)</m>.</p></response>
        </match>
        <match>
          <premise>
            <m>\fourvec{0}{0}{0}{0}</m>
          </premise>
          <response>
            <p>In both <m>\nul(A)</m> and
            <m>\col(A)</m>.</p>
          </response>
        </match>
      </cardsort>
    </exercise>

    <exercise component="proteus"
              label="ula-proteus-3-5-matchdim-v1">
      <title>Determining dimensions of subspaces</title>
      <statement>
        <p>Suppose <m>A</m> is a <m>23\times 24</m> matrix with
        <m>\rank(A)=22</m>. Match the unknown values on the left with
        the values on the right.</p>
      </statement>
      <cardsort>
        <match>
          <response><m>1</m></response>
        </match>
        <match>
          <premise><p>The dimension of <m>\nul(A)</m>.</p></premise>
          <premise><p>The number of free variables describing the
          solutions to <m>A\xvec =\zerovec</m>.</p></premise>
          <response><m>2</m></response>
        </match>
        <match>
          <response><m>3</m></response>
        </match>
        <match>
          <premise><p>The dimension of <m>\col(A)</m>.</p></premise>
          <premise><p>The number of pivot positions in <m>A</m>.</p></premise>
          <premise><p>The number of linearly independent columns of
          <m>A</m>.</p></premise>
          <response><m>22</m></response>
        </match>

        <match>
          <premise><p><m>\col(A)</m> is a subspace of <m>\real^p</m> for which <m>p</m>?</p></premise>
          <response><m>23</m></response>
        </match>
        <match>
          <premise><p><m>\nul(A)</m> is a subspace of <m>\real^p</m> for which <m>p</m>?</p></premise>
          <premise><p><m>\dim(\nul(A))+\dim(\col(A))=</m>?</p></premise>
          <response><m>24</m></response>
        </match>

      </cardsort>

    </exercise>

    <exercise component="proteus"
              label="ula-proteus-3-5-matching-rank-true-false-sometimes">
      <title>Implications of an <m>n\times n</m> matrix having rank
      <m>n</m></title>

      <statement>
        <p>
          Suppose <m>A</m> is a <m>7\times 7</m> matrix with
          <m>\rank(A) = 7</m>.  Decide whether each of the statements
          on the left is always true, sometimes true, or never true.
        </p>
      </statement>

      <feedback>
        <p>You may wish to review how the rank of a matrix relates to
        its RREF, as well as how the RREF relates to concepts such as
        invertibility, the determinant, solutions to linear systems,
        and the dimensions of the column space and the null space.
        </p>
      </feedback>

      <cardsort>
        <match>
          <premise>
            <m>A</m> is invertible.
          </premise>
          <premise>
            <m>\col(A)</m> is <m>\real^7</m>.
          </premise>
          <premise>
            The columns of <m>A</m> form a basis of <m>\real^7</m>.
          </premise>
          <premise>
            The reduced row echelon form of <m>A</m> is <m>I_7</m>.
          </premise>
          <premise>
            If <m>A\xvec = \zerovec</m>, then <m>\xvec=\zerovec</m>.
          </premise>
          <response>Always true</response>
        </match>
        <match>
          <premise>
            <m>\det(A)=0</m>.
          </premise>
          <premise>
            <m>A\xvec = \zerovec</m> for some nonzero <m>\xvec</m> in
            <m>\real^7</m>.
          </premise>
          <premise>
            <m>A\xvec = \bvec</m> is inconsistent for some vector
            <m>\bvec</m> in <m>\real^7</m>.
          </premise>
          <premise>
            <m>A</m> has a column without a pivot position.
          </premise>
          <response>Never true</response>
        </match>
        <match>
          <premise>
            <m>A=I_7</m>.
          </premise>
          <premise>
            <m>\det(A)=1</m>.
          </premise>
          <response>Sometimes true</response>
        </match>
      </cardsort>
    </exercise>


  </subsection>

  <xi:include href="exercises/exercises3-5.xml" />

</section>
